(function(){const be=document.createElement("link").relList;if(be&&be.supports&&be.supports("modulepreload"))return;for(const V of document.querySelectorAll('link[rel="modulepreload"]'))_e(V);new MutationObserver(V=>{for(const je of V)if(je.type==="childList")for(const z of je.addedNodes)z.tagName==="LINK"&&z.rel==="modulepreload"&&_e(z)}).observe(document,{childList:!0,subtree:!0});function ze(V){const je={};return V.integrity&&(je.integrity=V.integrity),V.referrerPolicy&&(je.referrerPolicy=V.referrerPolicy),V.crossOrigin==="use-credentials"?je.credentials="include":V.crossOrigin==="anonymous"?je.credentials="omit":je.credentials="same-origin",je}function _e(V){if(V.ep)return;V.ep=!0;const je=ze(V);fetch(V.href,je)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},lsplugin_user={exports:{}};/*! For license information please see lsplugin.user.js.LICENSE.txt */lsplugin_user.exports;(function(oe,be){(function(ze,_e){oe.exports=_e()})(self,()=>(()=>{var ze={227:(z,h,k)=>{var M=k(155);h.formatArgs=function(L){if(L[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+L[0]+(this.useColors?"%c ":" ")+"+"+z.exports.humanize(this.diff),!this.useColors)return;const Y="color: "+this.color;L.splice(1,0,Y,"color: inherit");let y=0,d=0;L[0].replace(/%[a-zA-Z%]/g,b=>{b!=="%%"&&(y++,b==="%c"&&(d=y))}),L.splice(d,0,Y)},h.save=function(L){try{L?h.storage.setItem("debug",L):h.storage.removeItem("debug")}catch{}},h.load=function(){let L;try{L=h.storage.getItem("debug")}catch{}return!L&&M!==void 0&&"env"in M&&(L=M.env.DEBUG),L},h.useColors=function(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},h.storage=function(){try{return localStorage}catch{}}(),h.destroy=(()=>{let L=!1;return()=>{L||(L=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),h.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],h.log=console.debug||console.log||(()=>{}),z.exports=k(447)(h);const{formatters:S}=z.exports;S.j=function(L){try{return JSON.stringify(L)}catch(Y){return"[UnexpectedJSONParseError]: "+Y.message}}},447:(z,h,k)=>{z.exports=function(M){function S(y){let d,b,_,D=null;function F(...$){if(!F.enabled)return;const B=F,E=Number(new Date),N=E-(d||E);B.diff=N,B.prev=d,B.curr=E,d=E,$[0]=S.coerce($[0]),typeof $[0]!="string"&&$.unshift("%O");let a=0;$[0]=$[0].replace(/%([a-zA-Z%])/g,(l,m)=>{if(l==="%%")return"%";a++;const O=S.formatters[m];if(typeof O=="function"){const G=$[a];l=O.call(B,G),$.splice(a,1),a--}return l}),S.formatArgs.call(B,$),(B.log||S.log).apply(B,$)}return F.namespace=y,F.useColors=S.useColors(),F.color=S.selectColor(y),F.extend=L,F.destroy=S.destroy,Object.defineProperty(F,"enabled",{enumerable:!0,configurable:!1,get:()=>D!==null?D:(b!==S.namespaces&&(b=S.namespaces,_=S.enabled(y)),_),set:$=>{D=$}}),typeof S.init=="function"&&S.init(F),F}function L(y,d){const b=S(this.namespace+(d===void 0?":":d)+y);return b.log=this.log,b}function Y(y){return y.toString().substring(2,y.toString().length-2).replace(/\.\*\?$/,"*")}return S.debug=S,S.default=S,S.coerce=function(y){return y instanceof Error?y.stack||y.message:y},S.disable=function(){const y=[...S.names.map(Y),...S.skips.map(Y).map(d=>"-"+d)].join(",");return S.enable(""),y},S.enable=function(y){let d;S.save(y),S.namespaces=y,S.names=[],S.skips=[];const b=(typeof y=="string"?y:"").split(/[\s,]+/),_=b.length;for(d=0;d<_;d++)b[d]&&((y=b[d].replace(/\*/g,".*?"))[0]==="-"?S.skips.push(new RegExp("^"+y.slice(1)+"$")):S.names.push(new RegExp("^"+y+"$")))},S.enabled=function(y){if(y[y.length-1]==="*")return!0;let d,b;for(d=0,b=S.skips.length;d<b;d++)if(S.skips[d].test(y))return!1;for(d=0,b=S.names.length;d<b;d++)if(S.names[d].test(y))return!0;return!1},S.humanize=k(824),S.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(M).forEach(y=>{S[y]=M[y]}),S.names=[],S.skips=[],S.formatters={},S.selectColor=function(y){let d=0;for(let b=0;b<y.length;b++)d=(d<<5)-d+y.charCodeAt(b),d|=0;return S.colors[Math.abs(d)%S.colors.length]},S.enable(S.load()),S}},856:function(z){z.exports=function(){function h(x){return h=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(j){return typeof j}:function(j){return j&&typeof Symbol=="function"&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j},h(x)}function k(x,j){return k=Object.setPrototypeOf||function(q,K){return q.__proto__=K,q},k(x,j)}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function S(x,j,q){return S=M()?Reflect.construct:function(K,ie,Le){var Ze=[null];Ze.push.apply(Ze,ie);var Ne=new(Function.bind.apply(K,Ze));return Le&&k(Ne,Le.prototype),Ne},S.apply(null,arguments)}function L(x){return Y(x)||y(x)||d(x)||_()}function Y(x){if(Array.isArray(x))return b(x)}function y(x){if(typeof Symbol<"u"&&x[Symbol.iterator]!=null||x["@@iterator"]!=null)return Array.from(x)}function d(x,j){if(x){if(typeof x=="string")return b(x,j);var q=Object.prototype.toString.call(x).slice(8,-1);return q==="Object"&&x.constructor&&(q=x.constructor.name),q==="Map"||q==="Set"?Array.from(x):q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(q)?b(x,j):void 0}}function b(x,j){(j==null||j>x.length)&&(j=x.length);for(var q=0,K=new Array(j);q<j;q++)K[q]=x[q];return K}function _(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var D=Object.hasOwnProperty,F=Object.setPrototypeOf,$=Object.isFrozen,B=Object.getPrototypeOf,E=Object.getOwnPropertyDescriptor,N=Object.freeze,a=Object.seal,l=Object.create,m=typeof Reflect<"u"&&Reflect,O=m.apply,G=m.construct;O||(O=function(x,j,q){return x.apply(j,q)}),N||(N=function(x){return x}),a||(a=function(x){return x}),G||(G=function(x,j){return S(x,L(j))});var Q=ee(Array.prototype.forEach),re=ee(Array.prototype.pop),de=ee(Array.prototype.push),we=ee(String.prototype.toLowerCase),xe=ee(String.prototype.match),ue=ee(String.prototype.replace),Me=ee(String.prototype.indexOf),p=ee(String.prototype.trim),v=ee(RegExp.prototype.test),P=Ce(TypeError);function ee(x){return function(j){for(var q=arguments.length,K=new Array(q>1?q-1:0),ie=1;ie<q;ie++)K[ie-1]=arguments[ie];return O(x,j,K)}}function Ce(x){return function(){for(var j=arguments.length,q=new Array(j),K=0;K<j;K++)q[K]=arguments[K];return G(x,q)}}function R(x,j){F&&F(x,null);for(var q=j.length;q--;){var K=j[q];if(typeof K=="string"){var ie=we(K);ie!==K&&($(j)||(j[q]=ie),K=ie)}x[K]=!0}return x}function W(x){var j,q=l(null);for(j in x)O(D,x,[j])&&(q[j]=x[j]);return q}function ae(x,j){for(;x!==null;){var q=E(x,j);if(q){if(q.get)return ee(q.get);if(typeof q.value=="function")return ee(q.value)}x=B(x)}function K(ie){return console.warn("fallback value for",ie),null}return K}var Ae=N(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Oe=N(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),qe=N(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),tt=N(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),fe=N(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),ce=N(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Se=N(["#text"]),ke=N(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),Te=N(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Fe=N(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Pe=N(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ft=a(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xt=a(/<%[\w\W]*|[\w\W]*%>/gm),In=a(/^data-[\-\w.\u00B7-\uFFFF]/),Mn=a(/^aria-[\-\w]+$/),Fn=a(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Ln=a(/^(?:\w+script|data):/i),nt=a(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),an=a(/^html$/i),Nn=function(){return typeof window>"u"?null:window},Pn=function(x,j){if(h(x)!=="object"||typeof x.createPolicy!="function")return null;var q=null,K="data-tt-policy-suffix";j.currentScript&&j.currentScript.hasAttribute(K)&&(q=j.currentScript.getAttribute(K));var ie="dompurify"+(q?"#"+q:"");try{return x.createPolicy(ie,{createHTML:function(Le){return Le}})}catch{return console.warn("TrustedTypes policy "+ie+" could not be created."),null}};function ut(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Nn(),j=function(i){return ut(i)};if(j.version="2.3.8",j.removed=[],!x||!x.document||x.document.nodeType!==9)return j.isSupported=!1,j;var q=x.document,K=x.document,ie=x.DocumentFragment,Le=x.HTMLTemplateElement,Ze=x.Node,Ne=x.Element,Ve=x.NodeFilter,ft=x.NamedNodeMap,Ct=ft===void 0?x.NamedNodeMap||x.MozNamedAttrMap:ft,Lt=x.HTMLFormElement,cn=x.DOMParser,ln=x.trustedTypes,pt=Ne.prototype,un=ae(pt,"cloneNode"),fn=ae(pt,"nextSibling"),Rn=ae(pt,"childNodes"),rt=ae(pt,"parentNode");if(typeof Le=="function"){var Nt=K.createElement("template");Nt.content&&Nt.content.ownerDocument&&(K=Nt.content.ownerDocument)}var He=Pn(ln,q),pn=He?He.createHTML(""):"",dt=K,Pt=dt.implementation,dn=dt.createNodeIterator,hn=dt.createDocumentFragment,Dn=dt.getElementsByTagName,Rt=q.importNode,gn={};try{gn=W(K).documentMode?K.documentMode:{}}catch{}var me={};j.isSupported=typeof rt=="function"&&Pt&&Pt.createHTMLDocument!==void 0&&gn!==9;var ot,Be,Dt=Ft,$t=xt,Ot=In,Ie=Mn,Ut=Ln,ht=nt,zt=Fn,he=null,qt=R({},[].concat(L(Ae),L(Oe),L(qe),L(fe),L(Se))),ge=null,Ht=R({},[].concat(L(ke),L(Te),L(Fe),L(Pe))),se=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),gt=null,Bt=null,Gt=!0,Wt=!0,mn=!1,it=!1,X=!1,Jt=!1,Kt=!1,Ye=!1,Ge=!1,st=!1,Zt=!0,St=!0,Qe=!1,We={},at=null,vn=R({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),yn=null,bn=R({},["audio","video","img","source","image","track"]),Vt=null,kt=R({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Yt="http://www.w3.org/1998/Math/MathML",jt="http://www.w3.org/2000/svg",Je="http://www.w3.org/1999/xhtml",At=Je,_n=!1,wn=["application/xhtml+xml","text/html"],$n="text/html",ct=null,Un=K.createElement("form"),Et=function(i){return i instanceof RegExp||i instanceof Function},Qt=function(i){ct&&ct===i||(i&&h(i)==="object"||(i={}),i=W(i),he="ALLOWED_TAGS"in i?R({},i.ALLOWED_TAGS):qt,ge="ALLOWED_ATTR"in i?R({},i.ALLOWED_ATTR):Ht,Vt="ADD_URI_SAFE_ATTR"in i?R(W(kt),i.ADD_URI_SAFE_ATTR):kt,yn="ADD_DATA_URI_TAGS"in i?R(W(bn),i.ADD_DATA_URI_TAGS):bn,at="FORBID_CONTENTS"in i?R({},i.FORBID_CONTENTS):vn,gt="FORBID_TAGS"in i?R({},i.FORBID_TAGS):{},Bt="FORBID_ATTR"in i?R({},i.FORBID_ATTR):{},We="USE_PROFILES"in i&&i.USE_PROFILES,Gt=i.ALLOW_ARIA_ATTR!==!1,Wt=i.ALLOW_DATA_ATTR!==!1,mn=i.ALLOW_UNKNOWN_PROTOCOLS||!1,it=i.SAFE_FOR_TEMPLATES||!1,X=i.WHOLE_DOCUMENT||!1,Ye=i.RETURN_DOM||!1,Ge=i.RETURN_DOM_FRAGMENT||!1,st=i.RETURN_TRUSTED_TYPE||!1,Kt=i.FORCE_BODY||!1,Zt=i.SANITIZE_DOM!==!1,St=i.KEEP_CONTENT!==!1,Qe=i.IN_PLACE||!1,zt=i.ALLOWED_URI_REGEXP||zt,At=i.NAMESPACE||Je,i.CUSTOM_ELEMENT_HANDLING&&Et(i.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(se.tagNameCheck=i.CUSTOM_ELEMENT_HANDLING.tagNameCheck),i.CUSTOM_ELEMENT_HANDLING&&Et(i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(se.attributeNameCheck=i.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),i.CUSTOM_ELEMENT_HANDLING&&typeof i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(se.allowCustomizedBuiltInElements=i.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),ot=ot=wn.indexOf(i.PARSER_MEDIA_TYPE)===-1?$n:i.PARSER_MEDIA_TYPE,Be=ot==="application/xhtml+xml"?function(C){return C}:we,it&&(Wt=!1),Ge&&(Ye=!0),We&&(he=R({},L(Se)),ge=[],We.html===!0&&(R(he,Ae),R(ge,ke)),We.svg===!0&&(R(he,Oe),R(ge,Te),R(ge,Pe)),We.svgFilters===!0&&(R(he,qe),R(ge,Te),R(ge,Pe)),We.mathMl===!0&&(R(he,fe),R(ge,Fe),R(ge,Pe))),i.ADD_TAGS&&(he===qt&&(he=W(he)),R(he,i.ADD_TAGS)),i.ADD_ATTR&&(ge===Ht&&(ge=W(ge)),R(ge,i.ADD_ATTR)),i.ADD_URI_SAFE_ATTR&&R(Vt,i.ADD_URI_SAFE_ATTR),i.FORBID_CONTENTS&&(at===vn&&(at=W(at)),R(at,i.FORBID_CONTENTS)),St&&(he["#text"]=!0),X&&R(he,["html","head","body"]),he.table&&(R(he,["tbody"]),delete gt.tbody),N&&N(i),ct=i)},Xt=R({},["mi","mo","mn","ms","mtext"]),xn=R({},["foreignobject","desc","title","annotation-xml"]),zn=R({},["title","style","font","a","script"]),Tt=R({},Oe);R(Tt,qe),R(Tt,tt);var en=R({},fe);R(en,ce);var qn=function(i){var C=rt(i);C&&C.tagName||(C={namespaceURI:Je,tagName:"template"});var w=we(i.tagName),te=we(C.tagName);return i.namespaceURI===jt?C.namespaceURI===Je?w==="svg":C.namespaceURI===Yt?w==="svg"&&(te==="annotation-xml"||Xt[te]):!!Tt[w]:i.namespaceURI===Yt?C.namespaceURI===Je?w==="math":C.namespaceURI===jt?w==="math"&&xn[te]:!!en[w]:i.namespaceURI===Je&&!(C.namespaceURI===jt&&!xn[te])&&!(C.namespaceURI===Yt&&!Xt[te])&&!en[w]&&(zn[w]||!Tt[w])},Re=function(i){de(j.removed,{element:i});try{i.parentNode.removeChild(i)}catch{try{i.outerHTML=pn}catch{i.remove()}}},Cn=function(i,C){try{de(j.removed,{attribute:C.getAttributeNode(i),from:C})}catch{de(j.removed,{attribute:null,from:C})}if(C.removeAttribute(i),i==="is"&&!ge[i])if(Ye||Ge)try{Re(C)}catch{}else try{C.setAttribute(i,"")}catch{}},On=function(i){var C,w;if(Kt)i="<remove></remove>"+i;else{var te=xe(i,/^[\r\n\t ]+/);w=te&&te[0]}ot==="application/xhtml+xml"&&(i='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+i+"</body></html>");var le=He?He.createHTML(i):i;if(At===Je)try{C=new cn().parseFromString(le,ot)}catch{}if(!C||!C.documentElement){C=Pt.createDocument(At,"template",null);try{C.documentElement.innerHTML=_n?"":le}catch{}}var ve=C.body||C.documentElement;return i&&w&&ve.insertBefore(K.createTextNode(w),ve.childNodes[0]||null),At===Je?Dn.call(C,X?"html":"body")[0]:X?C.documentElement:ve},mt=function(i){return dn.call(i.ownerDocument||i,i,Ve.SHOW_ELEMENT|Ve.SHOW_COMMENT|Ve.SHOW_TEXT,null,!1)},Hn=function(i){return i instanceof Lt&&(typeof i.nodeName!="string"||typeof i.textContent!="string"||typeof i.removeChild!="function"||!(i.attributes instanceof Ct)||typeof i.removeAttribute!="function"||typeof i.setAttribute!="function"||typeof i.namespaceURI!="string"||typeof i.insertBefore!="function")},vt=function(i){return h(Ze)==="object"?i instanceof Ze:i&&h(i)==="object"&&typeof i.nodeType=="number"&&typeof i.nodeName=="string"},De=function(i,C,w){me[i]&&Q(me[i],function(te){te.call(j,C,w,ct)})},tn=function(i){var C;if(De("beforeSanitizeElements",i,null),Hn(i)||v(/[\u0080-\uFFFF]/,i.nodeName))return Re(i),!0;var w=Be(i.nodeName);if(De("uponSanitizeElement",i,{tagName:w,allowedTags:he}),i.hasChildNodes()&&!vt(i.firstElementChild)&&(!vt(i.content)||!vt(i.content.firstElementChild))&&v(/<[/\w]/g,i.innerHTML)&&v(/<[/\w]/g,i.textContent)||w==="select"&&v(/<template/i,i.innerHTML))return Re(i),!0;if(!he[w]||gt[w]){if(!gt[w]&&nn(w)&&(se.tagNameCheck instanceof RegExp&&v(se.tagNameCheck,w)||se.tagNameCheck instanceof Function&&se.tagNameCheck(w)))return!1;if(St&&!at[w]){var te=rt(i)||i.parentNode,le=Rn(i)||i.childNodes;if(le&&te)for(var ve=le.length-1;ve>=0;--ve)te.insertBefore(un(le[ve],!0),fn(i))}return Re(i),!0}return i instanceof Ne&&!qn(i)?(Re(i),!0):w!=="noscript"&&w!=="noembed"||!v(/<\/no(script|embed)/i,i.innerHTML)?(it&&i.nodeType===3&&(C=i.textContent,C=ue(C,Dt," "),C=ue(C,$t," "),i.textContent!==C&&(de(j.removed,{element:i.cloneNode()}),i.textContent=C)),De("afterSanitizeElements",i,null),!1):(Re(i),!0)},Sn=function(i,C,w){if(Zt&&(C==="id"||C==="name")&&(w in K||w in Un))return!1;if(!(Wt&&!Bt[C]&&v(Ot,C))){if(!(Gt&&v(Ie,C))){if(!ge[C]||Bt[C]){if(!(nn(i)&&(se.tagNameCheck instanceof RegExp&&v(se.tagNameCheck,i)||se.tagNameCheck instanceof Function&&se.tagNameCheck(i))&&(se.attributeNameCheck instanceof RegExp&&v(se.attributeNameCheck,C)||se.attributeNameCheck instanceof Function&&se.attributeNameCheck(C))||C==="is"&&se.allowCustomizedBuiltInElements&&(se.tagNameCheck instanceof RegExp&&v(se.tagNameCheck,w)||se.tagNameCheck instanceof Function&&se.tagNameCheck(w))))return!1}else if(!Vt[C]){if(!v(zt,ue(w,ht,""))){if((C!=="src"&&C!=="xlink:href"&&C!=="href"||i==="script"||Me(w,"data:")!==0||!yn[i])&&!(mn&&!v(Ut,ue(w,ht,"")))){if(w)return!1}}}}}return!0},nn=function(i){return i.indexOf("-")>0},yt=function(i){var C,w,te,le;De("beforeSanitizeAttributes",i,null);var ve=i.attributes;if(ve){var ye={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ge};for(le=ve.length;le--;){var bt=C=ve[le],$e=bt.name,Z=bt.namespaceURI;if(w=$e==="value"?C.value:p(C.value),te=Be($e),ye.attrName=te,ye.attrValue=w,ye.keepAttr=!0,ye.forceKeepAttr=void 0,De("uponSanitizeAttribute",i,ye),w=ye.attrValue,!ye.forceKeepAttr&&(Cn($e,i),ye.keepAttr))if(v(/\/>/i,w))Cn($e,i);else{it&&(w=ue(w,Dt," "),w=ue(w,$t," "));var Xe=Be(i.nodeName);if(Sn(Xe,te,w))try{Z?i.setAttributeNS(Z,$e,w):i.setAttribute($e,w),re(j.removed)}catch{}}}De("afterSanitizeAttributes",i,null)}},rn=function i(C){var w,te=mt(C);for(De("beforeSanitizeShadowDOM",C,null);w=te.nextNode();)De("uponSanitizeShadowNode",w,null),tn(w)||(w.content instanceof ie&&i(w.content),yt(w));De("afterSanitizeShadowDOM",C,null)};return j.sanitize=function(i,C){var w,te,le,ve,ye;if((_n=!i)&&(i="<!-->"),typeof i!="string"&&!vt(i)){if(typeof i.toString!="function")throw P("toString is not a function");if(typeof(i=i.toString())!="string")throw P("dirty is not a string, aborting")}if(!j.isSupported){if(h(x.toStaticHTML)==="object"||typeof x.toStaticHTML=="function"){if(typeof i=="string")return x.toStaticHTML(i);if(vt(i))return x.toStaticHTML(i.outerHTML)}return i}if(Jt||Qt(C),j.removed=[],typeof i=="string"&&(Qe=!1),Qe){if(i.nodeName){var bt=Be(i.nodeName);if(!he[bt]||gt[bt])throw P("root node is forbidden and cannot be sanitized in-place")}}else if(i instanceof Ze)(te=(w=On("<!---->")).ownerDocument.importNode(i,!0)).nodeType===1&&te.nodeName==="BODY"||te.nodeName==="HTML"?w=te:w.appendChild(te);else{if(!Ye&&!it&&!X&&i.indexOf("<")===-1)return He&&st?He.createHTML(i):i;if(!(w=On(i)))return Ye?null:st?pn:""}w&&Kt&&Re(w.firstChild);for(var $e=mt(Qe?i:w);le=$e.nextNode();)le.nodeType===3&&le===ve||tn(le)||(le.content instanceof ie&&rn(le.content),yt(le),ve=le);if(ve=null,Qe)return i;if(Ye){if(Ge)for(ye=hn.call(w.ownerDocument);w.firstChild;)ye.appendChild(w.firstChild);else ye=w;return ge.shadowroot&&(ye=Rt.call(q,ye,!0)),ye}var Z=X?w.outerHTML:w.innerHTML;return X&&he["!doctype"]&&w.ownerDocument&&w.ownerDocument.doctype&&w.ownerDocument.doctype.name&&v(an,w.ownerDocument.doctype.name)&&(Z="<!DOCTYPE "+w.ownerDocument.doctype.name+`>
`+Z),it&&(Z=ue(Z,Dt," "),Z=ue(Z,$t," ")),He&&st?He.createHTML(Z):Z},j.setConfig=function(i){Qt(i),Jt=!0},j.clearConfig=function(){ct=null,Jt=!1},j.isValidAttribute=function(i,C,w){ct||Qt({});var te=Be(i),le=Be(C);return Sn(te,le,w)},j.addHook=function(i,C){typeof C=="function"&&(me[i]=me[i]||[],de(me[i],C))},j.removeHook=function(i){if(me[i])return re(me[i])},j.removeHooks=function(i){me[i]&&(me[i]=[])},j.removeAllHooks=function(){me={}},j}return ut()}()},729:z=>{var h=Object.prototype.hasOwnProperty,k="~";function M(){}function S(d,b,_){this.fn=d,this.context=b,this.once=_||!1}function L(d,b,_,D,F){if(typeof _!="function")throw new TypeError("The listener must be a function");var $=new S(_,D||d,F),B=k?k+b:b;return d._events[B]?d._events[B].fn?d._events[B]=[d._events[B],$]:d._events[B].push($):(d._events[B]=$,d._eventsCount++),d}function Y(d,b){--d._eventsCount==0?d._events=new M:delete d._events[b]}function y(){this._events=new M,this._eventsCount=0}Object.create&&(M.prototype=Object.create(null),new M().__proto__||(k=!1)),y.prototype.eventNames=function(){var d,b,_=[];if(this._eventsCount===0)return _;for(b in d=this._events)h.call(d,b)&&_.push(k?b.slice(1):b);return Object.getOwnPropertySymbols?_.concat(Object.getOwnPropertySymbols(d)):_},y.prototype.listeners=function(d){var b=k?k+d:d,_=this._events[b];if(!_)return[];if(_.fn)return[_.fn];for(var D=0,F=_.length,$=new Array(F);D<F;D++)$[D]=_[D].fn;return $},y.prototype.listenerCount=function(d){var b=k?k+d:d,_=this._events[b];return _?_.fn?1:_.length:0},y.prototype.emit=function(d,b,_,D,F,$){var B=k?k+d:d;if(!this._events[B])return!1;var E,N,a=this._events[B],l=arguments.length;if(a.fn){switch(a.once&&this.removeListener(d,a.fn,void 0,!0),l){case 1:return a.fn.call(a.context),!0;case 2:return a.fn.call(a.context,b),!0;case 3:return a.fn.call(a.context,b,_),!0;case 4:return a.fn.call(a.context,b,_,D),!0;case 5:return a.fn.call(a.context,b,_,D,F),!0;case 6:return a.fn.call(a.context,b,_,D,F,$),!0}for(N=1,E=new Array(l-1);N<l;N++)E[N-1]=arguments[N];a.fn.apply(a.context,E)}else{var m,O=a.length;for(N=0;N<O;N++)switch(a[N].once&&this.removeListener(d,a[N].fn,void 0,!0),l){case 1:a[N].fn.call(a[N].context);break;case 2:a[N].fn.call(a[N].context,b);break;case 3:a[N].fn.call(a[N].context,b,_);break;case 4:a[N].fn.call(a[N].context,b,_,D);break;default:if(!E)for(m=1,E=new Array(l-1);m<l;m++)E[m-1]=arguments[m];a[N].fn.apply(a[N].context,E)}}return!0},y.prototype.on=function(d,b,_){return L(this,d,b,_,!1)},y.prototype.once=function(d,b,_){return L(this,d,b,_,!0)},y.prototype.removeListener=function(d,b,_,D){var F=k?k+d:d;if(!this._events[F])return this;if(!b)return Y(this,F),this;var $=this._events[F];if($.fn)$.fn!==b||D&&!$.once||_&&$.context!==_||Y(this,F);else{for(var B=0,E=[],N=$.length;B<N;B++)($[B].fn!==b||D&&!$[B].once||_&&$[B].context!==_)&&E.push($[B]);E.length?this._events[F]=E.length===1?E[0]:E:Y(this,F)}return this},y.prototype.removeAllListeners=function(d){var b;return d?(b=k?k+d:d,this._events[b]&&Y(this,b)):(this._events=new M,this._eventsCount=0),this},y.prototype.off=y.prototype.removeListener,y.prototype.addListener=y.prototype.on,y.prefixed=k,y.EventEmitter=y,z.exports=y},717:z=>{typeof Object.create=="function"?z.exports=function(h,k){h.super_=k,h.prototype=Object.create(k.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}})}:z.exports=function(h,k){h.super_=k;var M=function(){};M.prototype=k.prototype,h.prototype=new M,h.prototype.constructor=h}},824:z=>{var h=1e3,k=60*h,M=60*k,S=24*M,L=7*S,Y=365.25*S;function y(d,b,_,D){var F=b>=1.5*_;return Math.round(d/_)+" "+D+(F?"s":"")}z.exports=function(d,b){b=b||{};var _=typeof d;if(_==="string"&&d.length>0)return function(D){if(!((D=String(D)).length>100)){var F=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(D);if(F){var $=parseFloat(F[1]);switch((F[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return $*Y;case"weeks":case"week":case"w":return $*L;case"days":case"day":case"d":return $*S;case"hours":case"hour":case"hrs":case"hr":case"h":return $*M;case"minutes":case"minute":case"mins":case"min":case"m":return $*k;case"seconds":case"second":case"secs":case"sec":case"s":return $*h;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return $;default:return}}}}(d);if(_==="number"&&isFinite(d))return b.long?function(D){var F=Math.abs(D);return F>=S?y(D,F,S,"day"):F>=M?y(D,F,M,"hour"):F>=k?y(D,F,k,"minute"):F>=h?y(D,F,h,"second"):D+" ms"}(d):function(D){var F=Math.abs(D);return F>=S?Math.round(D/S)+"d":F>=M?Math.round(D/M)+"h":F>=k?Math.round(D/k)+"m":F>=h?Math.round(D/h)+"s":D+"ms"}(d);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(d))}},520:(z,h,k)=>{var M=k(155),S=M.platform==="win32",L=k(539);function Y(a,l){for(var m=[],O=0;O<a.length;O++){var G=a[O];G&&G!=="."&&(G===".."?m.length&&m[m.length-1]!==".."?m.pop():l&&m.push(".."):m.push(G))}return m}function y(a){for(var l=a.length-1,m=0;m<=l&&!a[m];m++);for(var O=l;O>=0&&!a[O];O--);return m===0&&O===l?a:m>O?[]:a.slice(m,O+1)}var d=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,b=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,_={};function D(a){var l=d.exec(a),m=(l[1]||"")+(l[2]||""),O=l[3]||"",G=b.exec(O);return[m,G[1],G[2],G[3]]}function F(a){var l=d.exec(a),m=l[1]||"",O=!!m&&m[1]!==":";return{device:m,isUnc:O,isAbsolute:O||!!l[2],tail:l[3]}}function $(a){return"\\\\"+a.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}_.resolve=function(){for(var a="",l="",m=!1,O=arguments.length-1;O>=-1;O--){var G;if(O>=0?G=arguments[O]:a?(G=M.env["="+a])&&G.substr(0,3).toLowerCase()===a.toLowerCase()+"\\"||(G=a+"\\"):G=M.cwd(),!L.isString(G))throw new TypeError("Arguments to path.resolve must be strings");if(G){var Q=F(G),re=Q.device,de=Q.isUnc,we=Q.isAbsolute,xe=Q.tail;if((!re||!a||re.toLowerCase()===a.toLowerCase())&&(a||(a=re),m||(l=xe+"\\"+l,m=we),a&&m))break}}return de&&(a=$(a)),a+(m?"\\":"")+(l=Y(l.split(/[\\\/]+/),!m).join("\\"))||"."},_.normalize=function(a){var l=F(a),m=l.device,O=l.isUnc,G=l.isAbsolute,Q=l.tail,re=/[\\\/]$/.test(Q);return(Q=Y(Q.split(/[\\\/]+/),!G).join("\\"))||G||(Q="."),Q&&re&&(Q+="\\"),O&&(m=$(m)),m+(G?"\\":"")+Q},_.isAbsolute=function(a){return F(a).isAbsolute},_.join=function(){for(var a=[],l=0;l<arguments.length;l++){var m=arguments[l];if(!L.isString(m))throw new TypeError("Arguments to path.join must be strings");m&&a.push(m)}var O=a.join("\\");return/^[\\\/]{2}[^\\\/]/.test(a[0])||(O=O.replace(/^[\\\/]{2,}/,"\\")),_.normalize(O)},_.relative=function(a,l){a=_.resolve(a),l=_.resolve(l);for(var m=a.toLowerCase(),O=l.toLowerCase(),G=y(l.split("\\")),Q=y(m.split("\\")),re=y(O.split("\\")),de=Math.min(Q.length,re.length),we=de,xe=0;xe<de;xe++)if(Q[xe]!==re[xe]){we=xe;break}if(we==0)return l;var ue=[];for(xe=we;xe<Q.length;xe++)ue.push("..");return(ue=ue.concat(G.slice(we))).join("\\")},_._makeLong=function(a){if(!L.isString(a))return a;if(!a)return"";var l=_.resolve(a);return/^[a-zA-Z]\:\\/.test(l)?"\\\\?\\"+l:/^\\\\[^?.]/.test(l)?"\\\\?\\UNC\\"+l.substring(2):a},_.dirname=function(a){var l=D(a),m=l[0],O=l[1];return m||O?(O&&(O=O.substr(0,O.length-1)),m+O):"."},_.basename=function(a,l){var m=D(a)[2];return l&&m.substr(-1*l.length)===l&&(m=m.substr(0,m.length-l.length)),m},_.extname=function(a){return D(a)[3]},_.format=function(a){if(!L.isObject(a))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof a);var l=a.root||"";if(!L.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof a.root);var m=a.dir,O=a.base||"";return m?m[m.length-1]===_.sep?m+O:m+_.sep+O:O},_.parse=function(a){if(!L.isString(a))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof a);var l=D(a);if(!l||l.length!==4)throw new TypeError("Invalid path '"+a+"'");return{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},_.sep="\\",_.delimiter=";";var B=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,E={};function N(a){return B.exec(a).slice(1)}E.resolve=function(){for(var a="",l=!1,m=arguments.length-1;m>=-1&&!l;m--){var O=m>=0?arguments[m]:M.cwd();if(!L.isString(O))throw new TypeError("Arguments to path.resolve must be strings");O&&(a=O+"/"+a,l=O[0]==="/")}return(l?"/":"")+(a=Y(a.split("/"),!l).join("/"))||"."},E.normalize=function(a){var l=E.isAbsolute(a),m=a&&a[a.length-1]==="/";return(a=Y(a.split("/"),!l).join("/"))||l||(a="."),a&&m&&(a+="/"),(l?"/":"")+a},E.isAbsolute=function(a){return a.charAt(0)==="/"},E.join=function(){for(var a="",l=0;l<arguments.length;l++){var m=arguments[l];if(!L.isString(m))throw new TypeError("Arguments to path.join must be strings");m&&(a+=a?"/"+m:m)}return E.normalize(a)},E.relative=function(a,l){a=E.resolve(a).substr(1),l=E.resolve(l).substr(1);for(var m=y(a.split("/")),O=y(l.split("/")),G=Math.min(m.length,O.length),Q=G,re=0;re<G;re++)if(m[re]!==O[re]){Q=re;break}var de=[];for(re=Q;re<m.length;re++)de.push("..");return(de=de.concat(O.slice(Q))).join("/")},E._makeLong=function(a){return a},E.dirname=function(a){var l=N(a),m=l[0],O=l[1];return m||O?(O&&(O=O.substr(0,O.length-1)),m+O):"."},E.basename=function(a,l){var m=N(a)[2];return l&&m.substr(-1*l.length)===l&&(m=m.substr(0,m.length-l.length)),m},E.extname=function(a){return N(a)[3]},E.format=function(a){if(!L.isObject(a))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof a);var l=a.root||"";if(!L.isString(l))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof a.root);return(a.dir?a.dir+E.sep:"")+(a.base||"")},E.parse=function(a){if(!L.isString(a))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof a);var l=N(a);if(!l||l.length!==4)throw new TypeError("Invalid path '"+a+"'");return l[1]=l[1]||"",l[2]=l[2]||"",l[3]=l[3]||"",{root:l[0],dir:l[0]+l[1].slice(0,-1),base:l[2],ext:l[3],name:l[2].slice(0,l[2].length-l[3].length)}},E.sep="/",E.delimiter=":",z.exports=S?_:E,z.exports.posix=E,z.exports.win32=_},155:z=>{var h,k,M=z.exports={};function S(){throw new Error("setTimeout has not been defined")}function L(){throw new Error("clearTimeout has not been defined")}function Y(E){if(h===setTimeout)return setTimeout(E,0);if((h===S||!h)&&setTimeout)return h=setTimeout,setTimeout(E,0);try{return h(E,0)}catch{try{return h.call(null,E,0)}catch{return h.call(this,E,0)}}}(function(){try{h=typeof setTimeout=="function"?setTimeout:S}catch{h=S}try{k=typeof clearTimeout=="function"?clearTimeout:L}catch{k=L}})();var y,d=[],b=!1,_=-1;function D(){b&&y&&(b=!1,y.length?d=y.concat(d):_=-1,d.length&&F())}function F(){if(!b){var E=Y(D);b=!0;for(var N=d.length;N;){for(y=d,d=[];++_<N;)y&&y[_].run();_=-1,N=d.length}y=null,b=!1,function(a){if(k===clearTimeout)return clearTimeout(a);if((k===L||!k)&&clearTimeout)return k=clearTimeout,clearTimeout(a);try{k(a)}catch{try{return k.call(null,a)}catch{return k.call(this,a)}}}(E)}}function $(E,N){this.fun=E,this.array=N}function B(){}M.nextTick=function(E){var N=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)N[a-1]=arguments[a];d.push(new $(E,N)),d.length!==1||b||Y(F)},$.prototype.run=function(){this.fun.apply(null,this.array)},M.title="browser",M.browser=!0,M.env={},M.argv=[],M.version="",M.versions={},M.on=B,M.addListener=B,M.once=B,M.off=B,M.removeListener=B,M.removeAllListeners=B,M.emit=B,M.prependListener=B,M.prependOnceListener=B,M.listeners=function(E){return[]},M.binding=function(E){throw new Error("process.binding is not supported")},M.cwd=function(){return"/"},M.chdir=function(E){throw new Error("process.chdir is not supported")},M.umask=function(){return 0}},384:z=>{z.exports=function(h){return h&&typeof h=="object"&&typeof h.copy=="function"&&typeof h.fill=="function"&&typeof h.readUInt8=="function"}},539:(z,h,k)=>{var M=k(155),S=/%[sdj%]/g;h.format=function(p){if(!a(p)){for(var v=[],P=0;P<arguments.length;P++)v.push(y(arguments[P]));return v.join(" ")}P=1;for(var ee=arguments,Ce=ee.length,R=String(p).replace(S,function(ae){if(ae==="%%")return"%";if(P>=Ce)return ae;switch(ae){case"%s":return String(ee[P++]);case"%d":return Number(ee[P++]);case"%j":try{return JSON.stringify(ee[P++])}catch{return"[Circular]"}default:return ae}}),W=ee[P];P<Ce;W=ee[++P])E(W)||!O(W)?R+=" "+W:R+=" "+y(W);return R},h.deprecate=function(p,v){if(l(k.g.process))return function(){return h.deprecate(p,v).apply(this,arguments)};if(M.noDeprecation===!0)return p;var P=!1;return function(){if(!P){if(M.throwDeprecation)throw new Error(v);M.traceDeprecation?console.trace(v):console.error(v),P=!0}return p.apply(this,arguments)}};var L,Y={};function y(p,v){var P={seen:[],stylize:b};return arguments.length>=3&&(P.depth=arguments[2]),arguments.length>=4&&(P.colors=arguments[3]),B(v)?P.showHidden=v:v&&h._extend(P,v),l(P.showHidden)&&(P.showHidden=!1),l(P.depth)&&(P.depth=2),l(P.colors)&&(P.colors=!1),l(P.customInspect)&&(P.customInspect=!0),P.colors&&(P.stylize=d),_(P,p,P.depth)}function d(p,v){var P=y.styles[v];return P?"\x1B["+y.colors[P][0]+"m"+p+"\x1B["+y.colors[P][1]+"m":p}function b(p,v){return p}function _(p,v,P){if(p.customInspect&&v&&re(v.inspect)&&v.inspect!==h.inspect&&(!v.constructor||v.constructor.prototype!==v)){var ee=v.inspect(P,p);return a(ee)||(ee=_(p,ee,P)),ee}var Ce=function(fe,ce){if(l(ce))return fe.stylize("undefined","undefined");if(a(ce)){var Se="'"+JSON.stringify(ce).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return fe.stylize(Se,"string")}if(N(ce))return fe.stylize(""+ce,"number");if(B(ce))return fe.stylize(""+ce,"boolean");if(E(ce))return fe.stylize("null","null")}(p,v);if(Ce)return Ce;var R=Object.keys(v),W=function(fe){var ce={};return fe.forEach(function(Se,ke){ce[Se]=!0}),ce}(R);if(p.showHidden&&(R=Object.getOwnPropertyNames(v)),Q(v)&&(R.indexOf("message")>=0||R.indexOf("description")>=0))return D(v);if(R.length===0){if(re(v)){var ae=v.name?": "+v.name:"";return p.stylize("[Function"+ae+"]","special")}if(m(v))return p.stylize(RegExp.prototype.toString.call(v),"regexp");if(G(v))return p.stylize(Date.prototype.toString.call(v),"date");if(Q(v))return D(v)}var Ae,Oe="",qe=!1,tt=["{","}"];return $(v)&&(qe=!0,tt=["[","]"]),re(v)&&(Oe=" [Function"+(v.name?": "+v.name:"")+"]"),m(v)&&(Oe=" "+RegExp.prototype.toString.call(v)),G(v)&&(Oe=" "+Date.prototype.toUTCString.call(v)),Q(v)&&(Oe=" "+D(v)),R.length!==0||qe&&v.length!=0?P<0?m(v)?p.stylize(RegExp.prototype.toString.call(v),"regexp"):p.stylize("[Object]","special"):(p.seen.push(v),Ae=qe?function(fe,ce,Se,ke,Te){for(var Fe=[],Pe=0,Ft=ce.length;Pe<Ft;++Pe)Me(ce,String(Pe))?Fe.push(F(fe,ce,Se,ke,String(Pe),!0)):Fe.push("");return Te.forEach(function(xt){xt.match(/^\d+$/)||Fe.push(F(fe,ce,Se,ke,xt,!0))}),Fe}(p,v,P,W,R):R.map(function(fe){return F(p,v,P,W,fe,qe)}),p.seen.pop(),function(fe,ce,Se){return fe.reduce(function(ke,Te){return Te.indexOf(`
`)>=0,ke+Te.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?Se[0]+(ce===""?"":ce+`
 `)+" "+fe.join(`,
  `)+" "+Se[1]:Se[0]+ce+" "+fe.join(", ")+" "+Se[1]}(Ae,Oe,tt)):tt[0]+Oe+tt[1]}function D(p){return"["+Error.prototype.toString.call(p)+"]"}function F(p,v,P,ee,Ce,R){var W,ae,Ae;if((Ae=Object.getOwnPropertyDescriptor(v,Ce)||{value:v[Ce]}).get?ae=Ae.set?p.stylize("[Getter/Setter]","special"):p.stylize("[Getter]","special"):Ae.set&&(ae=p.stylize("[Setter]","special")),Me(ee,Ce)||(W="["+Ce+"]"),ae||(p.seen.indexOf(Ae.value)<0?(ae=E(P)?_(p,Ae.value,null):_(p,Ae.value,P-1)).indexOf(`
`)>-1&&(ae=R?ae.split(`
`).map(function(Oe){return"  "+Oe}).join(`
`).substr(2):`
`+ae.split(`
`).map(function(Oe){return"   "+Oe}).join(`
`)):ae=p.stylize("[Circular]","special")),l(W)){if(R&&Ce.match(/^\d+$/))return ae;(W=JSON.stringify(""+Ce)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(W=W.substr(1,W.length-2),W=p.stylize(W,"name")):(W=W.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),W=p.stylize(W,"string"))}return W+": "+ae}function $(p){return Array.isArray(p)}function B(p){return typeof p=="boolean"}function E(p){return p===null}function N(p){return typeof p=="number"}function a(p){return typeof p=="string"}function l(p){return p===void 0}function m(p){return O(p)&&de(p)==="[object RegExp]"}function O(p){return typeof p=="object"&&p!==null}function G(p){return O(p)&&de(p)==="[object Date]"}function Q(p){return O(p)&&(de(p)==="[object Error]"||p instanceof Error)}function re(p){return typeof p=="function"}function de(p){return Object.prototype.toString.call(p)}function we(p){return p<10?"0"+p.toString(10):p.toString(10)}h.debuglog=function(p){if(l(L)&&(L=M.env.NODE_DEBUG||""),p=p.toUpperCase(),!Y[p])if(new RegExp("\\b"+p+"\\b","i").test(L)){var v=M.pid;Y[p]=function(){var P=h.format.apply(h,arguments);console.error("%s %d: %s",p,v,P)}}else Y[p]=function(){};return Y[p]},h.inspect=y,y.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},y.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},h.isArray=$,h.isBoolean=B,h.isNull=E,h.isNullOrUndefined=function(p){return p==null},h.isNumber=N,h.isString=a,h.isSymbol=function(p){return typeof p=="symbol"},h.isUndefined=l,h.isRegExp=m,h.isObject=O,h.isDate=G,h.isError=Q,h.isFunction=re,h.isPrimitive=function(p){return p===null||typeof p=="boolean"||typeof p=="number"||typeof p=="string"||typeof p=="symbol"||p===void 0},h.isBuffer=k(384);var xe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ue(){var p=new Date,v=[we(p.getHours()),we(p.getMinutes()),we(p.getSeconds())].join(":");return[p.getDate(),xe[p.getMonth()],v].join(" ")}function Me(p,v){return Object.prototype.hasOwnProperty.call(p,v)}h.log=function(){console.log("%s - %s",ue(),h.format.apply(h,arguments))},h.inherits=k(717),h._extend=function(p,v){if(!v||!O(v))return p;for(var P=Object.keys(v),ee=P.length;ee--;)p[P[ee]]=v[P[ee]];return p}}},_e={};function V(z){var h=_e[z];if(h!==void 0)return h.exports;var k=_e[z]={exports:{}};return ze[z].call(k.exports,k,k.exports,V),k.exports}V.n=z=>{var h=z&&z.__esModule?()=>z.default:()=>z;return V.d(h,{a:h}),h},V.d=(z,h)=>{for(var k in h)V.o(h,k)&&!V.o(z,k)&&Object.defineProperty(z,k,{enumerable:!0,get:h[k]})},V.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),V.o=(z,h)=>Object.prototype.hasOwnProperty.call(z,h),V.r=z=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(z,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(z,"__esModule",{value:!0})};var je={};return(()=>{V.r(je),V.d(je,{LSPluginUser:()=>nr,setupPluginUserInstance:()=>Fr});var z=V(520);V(856);const h=function(){this.__data__=[],this.size=0},k=function(n,t){return n===t||n!=n&&t!=t},M=function(n,t){for(var r=n.length;r--;)if(k(n[r][0],t))return r;return-1};var S=Array.prototype.splice;const L=function(n){var t=this.__data__,r=M(t,n);return!(r<0)&&(r==t.length-1?t.pop():S.call(t,r,1),--this.size,!0)},Y=function(n){var t=this.__data__,r=M(t,n);return r<0?void 0:t[r][1]},y=function(n){return M(this.__data__,n)>-1},d=function(n,t){var r=this.__data__,o=M(r,n);return o<0?(++this.size,r.push([n,t])):r[o][1]=t,this};function b(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var o=n[t];this.set(o[0],o[1])}}b.prototype.clear=h,b.prototype.delete=L,b.prototype.get=Y,b.prototype.has=y,b.prototype.set=d;const _=b,D=function(){this.__data__=new _,this.size=0},F=function(n){var t=this.__data__,r=t.delete(n);return this.size=t.size,r},$=function(n){return this.__data__.get(n)},B=function(n){return this.__data__.has(n)},E=typeof commonjsGlobal=="object"&&commonjsGlobal&&commonjsGlobal.Object===Object&&commonjsGlobal;var N=typeof self=="object"&&self&&self.Object===Object&&self;const a=E||N||Function("return this")(),l=a.Symbol;var m=Object.prototype,O=m.hasOwnProperty,G=m.toString,Q=l?l.toStringTag:void 0;const re=function(n){var t=O.call(n,Q),r=n[Q];try{n[Q]=void 0;var o=!0}catch{}var s=G.call(n);return o&&(t?n[Q]=r:delete n[Q]),s};var de=Object.prototype.toString;const we=function(n){return de.call(n)};var xe=l?l.toStringTag:void 0;const ue=function(n){return n==null?n===void 0?"[object Undefined]":"[object Null]":xe&&xe in Object(n)?re(n):we(n)},Me=function(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")},p=function(n){if(!Me(n))return!1;var t=ue(n);return t=="[object Function]"||t=="[object GeneratorFunction]"||t=="[object AsyncFunction]"||t=="[object Proxy]"},v=a["__core-js_shared__"];var P,ee=(P=/[^.]+$/.exec(v&&v.keys&&v.keys.IE_PROTO||""))?"Symbol(src)_1."+P:"";const Ce=function(n){return!!ee&&ee in n};var R=Function.prototype.toString;const W=function(n){if(n!=null){try{return R.call(n)}catch{}try{return n+""}catch{}}return""};var ae=/^\[object .+?Constructor\]$/,Ae=Function.prototype,Oe=Object.prototype,qe=Ae.toString,tt=Oe.hasOwnProperty,fe=RegExp("^"+qe.call(tt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const ce=function(n){return!(!Me(n)||Ce(n))&&(p(n)?fe:ae).test(W(n))},Se=function(n,t){return n?.[t]},ke=function(n,t){var r=Se(n,t);return ce(r)?r:void 0},Te=ke(a,"Map"),Fe=ke(Object,"create"),Pe=function(){this.__data__=Fe?Fe(null):{},this.size=0},Ft=function(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t};var xt=Object.prototype.hasOwnProperty;const In=function(n){var t=this.__data__;if(Fe){var r=t[n];return r==="__lodash_hash_undefined__"?void 0:r}return xt.call(t,n)?t[n]:void 0};var Mn=Object.prototype.hasOwnProperty;const Fn=function(n){var t=this.__data__;return Fe?t[n]!==void 0:Mn.call(t,n)},Ln=function(n,t){var r=this.__data__;return this.size+=this.has(n)?0:1,r[n]=Fe&&t===void 0?"__lodash_hash_undefined__":t,this};function nt(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var o=n[t];this.set(o[0],o[1])}}nt.prototype.clear=Pe,nt.prototype.delete=Ft,nt.prototype.get=In,nt.prototype.has=Fn,nt.prototype.set=Ln;const an=nt,Nn=function(){this.size=0,this.__data__={hash:new an,map:new(Te||_),string:new an}},Pn=function(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null},ut=function(n,t){var r=n.__data__;return Pn(t)?r[typeof t=="string"?"string":"hash"]:r.map},x=function(n){var t=ut(this,n).delete(n);return this.size-=t?1:0,t},j=function(n){return ut(this,n).get(n)},q=function(n){return ut(this,n).has(n)},K=function(n,t){var r=ut(this,n),o=r.size;return r.set(n,t),this.size+=r.size==o?0:1,this};function ie(n){var t=-1,r=n==null?0:n.length;for(this.clear();++t<r;){var o=n[t];this.set(o[0],o[1])}}ie.prototype.clear=Nn,ie.prototype.delete=x,ie.prototype.get=j,ie.prototype.has=q,ie.prototype.set=K;const Le=ie,Ze=function(n,t){var r=this.__data__;if(r instanceof _){var o=r.__data__;if(!Te||o.length<199)return o.push([n,t]),this.size=++r.size,this;r=this.__data__=new Le(o)}return r.set(n,t),this.size=r.size,this};function Ne(n){var t=this.__data__=new _(n);this.size=t.size}Ne.prototype.clear=D,Ne.prototype.delete=F,Ne.prototype.get=$,Ne.prototype.has=B,Ne.prototype.set=Ze;const Ve=Ne,ft=function(){try{var n=ke(Object,"defineProperty");return n({},"",{}),n}catch{}}(),Ct=function(n,t,r){t=="__proto__"&&ft?ft(n,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):n[t]=r},Lt=function(n,t,r){(r!==void 0&&!k(n[t],r)||r===void 0&&!(t in n))&&Ct(n,t,r)},cn=function(n){return function(t,r,o){for(var s=-1,c=Object(t),u=o(t),f=u.length;f--;){var g=u[n?f:++s];if(r(c[g],g,c)===!1)break}return t}}();var ln=be&&!be.nodeType&&be,pt=ln&&!0&&oe&&!oe.nodeType&&oe,un=pt&&pt.exports===ln?a.Buffer:void 0,fn=un?un.allocUnsafe:void 0;const Rn=function(n,t){if(t)return n.slice();var r=n.length,o=fn?fn(r):new n.constructor(r);return n.copy(o),o},rt=a.Uint8Array,Nt=function(n){var t=new n.constructor(n.byteLength);return new rt(t).set(new rt(n)),t},He=function(n,t){var r=t?Nt(n.buffer):n.buffer;return new n.constructor(r,n.byteOffset,n.length)},pn=function(n,t){var r=-1,o=n.length;for(t||(t=Array(o));++r<o;)t[r]=n[r];return t};var dt=Object.create;const Pt=function(){function n(){}return function(t){if(!Me(t))return{};if(dt)return dt(t);n.prototype=t;var r=new n;return n.prototype=void 0,r}}(),dn=function(n,t){return function(r){return n(t(r))}},hn=dn(Object.getPrototypeOf,Object);var Dn=Object.prototype;const Rt=function(n){var t=n&&n.constructor;return n===(typeof t=="function"&&t.prototype||Dn)},gn=function(n){return typeof n.constructor!="function"||Rt(n)?{}:Pt(hn(n))},me=function(n){return n!=null&&typeof n=="object"},ot=function(n){return me(n)&&ue(n)=="[object Arguments]"};var Be=Object.prototype,Dt=Be.hasOwnProperty,$t=Be.propertyIsEnumerable;const Ot=ot(function(){return arguments}())?ot:function(n){return me(n)&&Dt.call(n,"callee")&&!$t.call(n,"callee")},Ie=Array.isArray,Ut=function(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=9007199254740991},ht=function(n){return n!=null&&Ut(n.length)&&!p(n)},zt=function(n){return me(n)&&ht(n)},he=function(){return!1};var qt=be&&!be.nodeType&&be,ge=qt&&!0&&oe&&!oe.nodeType&&oe,Ht=ge&&ge.exports===qt?a.Buffer:void 0;const se=(Ht?Ht.isBuffer:void 0)||he;var gt=Function.prototype,Bt=Object.prototype,Gt=gt.toString,Wt=Bt.hasOwnProperty,mn=Gt.call(Object);const it=function(n){if(!me(n)||ue(n)!="[object Object]")return!1;var t=hn(n);if(t===null)return!0;var r=Wt.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&Gt.call(r)==mn};var X={};X["[object Float32Array]"]=X["[object Float64Array]"]=X["[object Int8Array]"]=X["[object Int16Array]"]=X["[object Int32Array]"]=X["[object Uint8Array]"]=X["[object Uint8ClampedArray]"]=X["[object Uint16Array]"]=X["[object Uint32Array]"]=!0,X["[object Arguments]"]=X["[object Array]"]=X["[object ArrayBuffer]"]=X["[object Boolean]"]=X["[object DataView]"]=X["[object Date]"]=X["[object Error]"]=X["[object Function]"]=X["[object Map]"]=X["[object Number]"]=X["[object Object]"]=X["[object RegExp]"]=X["[object Set]"]=X["[object String]"]=X["[object WeakMap]"]=!1;const Jt=function(n){return me(n)&&Ut(n.length)&&!!X[ue(n)]},Kt=function(n){return function(t){return n(t)}};var Ye=be&&!be.nodeType&&be,Ge=Ye&&!0&&oe&&!oe.nodeType&&oe,st=Ge&&Ge.exports===Ye&&E.process,Zt=function(){try{var n=Ge&&Ge.require&&Ge.require("util").types;return n||st&&st.binding&&st.binding("util")}catch{}}(),St=Zt&&Zt.isTypedArray;const Qe=St?Kt(St):Jt,We=function(n,t){if((t!=="constructor"||typeof n[t]!="function")&&t!="__proto__")return n[t]};var at=Object.prototype.hasOwnProperty;const vn=function(n,t,r){var o=n[t];at.call(n,t)&&k(o,r)&&(r!==void 0||t in n)||Ct(n,t,r)},yn=function(n,t,r,o){var s=!r;r||(r={});for(var c=-1,u=t.length;++c<u;){var f=t[c],g=o?o(r[f],n[f],f,r,n):void 0;g===void 0&&(g=n[f]),s?Ct(r,f,g):vn(r,f,g)}return r},bn=function(n,t){for(var r=-1,o=Array(n);++r<n;)o[r]=t(r);return o};var Vt=/^(?:0|[1-9]\d*)$/;const kt=function(n,t){var r=typeof n;return!!(t=t??9007199254740991)&&(r=="number"||r!="symbol"&&Vt.test(n))&&n>-1&&n%1==0&&n<t};var Yt=Object.prototype.hasOwnProperty;const jt=function(n,t){var r=Ie(n),o=!r&&Ot(n),s=!r&&!o&&se(n),c=!r&&!o&&!s&&Qe(n),u=r||o||s||c,f=u?bn(n.length,String):[],g=f.length;for(var A in n)!t&&!Yt.call(n,A)||u&&(A=="length"||s&&(A=="offset"||A=="parent")||c&&(A=="buffer"||A=="byteLength"||A=="byteOffset")||kt(A,g))||f.push(A);return f},Je=function(n){var t=[];if(n!=null)for(var r in Object(n))t.push(r);return t};var At=Object.prototype.hasOwnProperty;const _n=function(n){if(!Me(n))return Je(n);var t=Rt(n),r=[];for(var o in n)(o!="constructor"||!t&&At.call(n,o))&&r.push(o);return r},wn=function(n){return ht(n)?jt(n,!0):_n(n)},$n=function(n){return yn(n,wn(n))},ct=function(n,t,r,o,s,c,u){var f=We(n,r),g=We(t,r),A=u.get(g);if(A)Lt(n,r,A);else{var T=c?c(f,g,r+"",n,t,u):void 0,I=T===void 0;if(I){var U=Ie(g),J=!U&&se(g),H=!U&&!J&&Qe(g);T=g,U||J||H?Ie(f)?T=f:zt(f)?T=pn(f):J?(I=!1,T=Rn(g,!0)):H?(I=!1,T=He(g,!0)):T=[]:it(g)||Ot(g)?(T=f,Ot(f)?T=$n(f):Me(f)&&!p(f)||(T=gn(g))):I=!1}I&&(u.set(g,T),s(T,g,o,c,u),u.delete(g)),Lt(n,r,T)}},Un=function n(t,r,o,s,c){t!==r&&cn(r,function(u,f){if(c||(c=new Ve),Me(u))ct(t,r,f,o,n,s,c);else{var g=s?s(We(t,f),u,f+"",t,r,c):void 0;g===void 0&&(g=u),Lt(t,f,g)}},wn)},Et=function(n){return n},Qt=function(n,t,r){switch(r.length){case 0:return n.call(t);case 1:return n.call(t,r[0]);case 2:return n.call(t,r[0],r[1]);case 3:return n.call(t,r[0],r[1],r[2])}return n.apply(t,r)};var Xt=Math.max;const xn=function(n,t,r){return t=Xt(t===void 0?n.length-1:t,0),function(){for(var o=arguments,s=-1,c=Xt(o.length-t,0),u=Array(c);++s<c;)u[s]=o[t+s];s=-1;for(var f=Array(t+1);++s<t;)f[s]=o[s];return f[t]=r(u),Qt(n,this,f)}},zn=function(n){return function(){return n}},Tt=ft?function(n,t){return ft(n,"toString",{configurable:!0,enumerable:!1,value:zn(t),writable:!0})}:Et;var en=Date.now;const qn=function(n){var t=0,r=0;return function(){var o=en(),s=16-(o-r);if(r=o,s>0){if(++t>=800)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}(Tt),Re=function(n,t){return qn(xn(n,t,Et),n+"")},Cn=function(n,t,r){if(!Me(r))return!1;var o=typeof t;return!!(o=="number"?ht(r)&&kt(t,r.length):o=="string"&&t in r)&&k(r[t],n)},On=function(n){return Re(function(t,r){var o=-1,s=r.length,c=s>1?r[s-1]:void 0,u=s>2?r[2]:void 0;for(c=n.length>3&&typeof c=="function"?(s--,c):void 0,u&&Cn(r[0],r[1],u)&&(c=s<3?void 0:c,s=1),t=Object(t);++o<s;){var f=r[o];f&&n(t,f,o,c)}return t})}(function(n,t,r){Un(n,t,r)});var mt=function(){return mt=Object.assign||function(n){for(var t,r=1,o=arguments.length;r<o;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s]);return n},mt.apply(this,arguments)};function Hn(n){return n.toLowerCase()}var vt=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],De=/[^A-Z0-9]+/gi;function tn(n,t,r){return t instanceof RegExp?n.replace(t,r):t.reduce(function(o,s){return o.replace(s,r)},n)}function Sn(n,t){return t===void 0&&(t={}),function(r,o){o===void 0&&(o={});for(var s=o.splitRegexp,c=s===void 0?vt:s,u=o.stripRegexp,f=u===void 0?De:u,g=o.transform,A=g===void 0?Hn:g,T=o.delimiter,I=T===void 0?" ":T,U=tn(tn(r,c,"$1\0$2"),f,"\0"),J=0,H=U.length;U.charAt(J)==="\0";)J++;for(;U.charAt(H-1)==="\0";)H--;return U.slice(J,H).split("\0").map(A).join(I)}(n,mt({delimiter:"."},t))}var nn=V(729),yt=V.n(nn);function rn(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const i=navigator.platform.toLowerCase()==="win32"?z.win32:z.posix,C=function(n,t){return t===void 0&&(t={}),Sn(n,mt({delimiter:"_"},t))},w=On;class te extends yt(){constructor(t,r){super(),rn(this,"_tag",void 0),rn(this,"_opts",void 0),rn(this,"_logs",[]),this._tag=t,this._opts=r}write(t,r,o){var s;r!=null&&r.length&&r[r.length-1]===!0&&(o=!0,r.pop());const c=r.reduce((f,g)=>(g&&g instanceof Error?f+=`${g.message} ${g.stack}`:f+=g.toString(),f),`[${this._tag}][${new Date().toLocaleTimeString()}] `);var u;this._logs.push([t,c]),(o||(s=this._opts)!==null&&s!==void 0&&s.console)&&((u=console)===null||u===void 0||u[t==="ERROR"?"error":"debug"](`${t}: ${c}`)),this.emit("change")}clear(){this._logs=[],this.emit("change")}info(...t){this.write("INFO",t)}error(...t){this.write("ERROR",t)}warn(...t){this.write("WARN",t)}setTag(t){this._tag=t}toJSON(){return this._logs}}function le(n,...t){try{const r=new URL(n);if(!r.origin)throw new Error(null);const o=i.join(n.substr(r.origin.length),...t);return r.origin+o}catch{return i.join(n,...t)}}function ve(n,t){let r,o,s=!1;const c=f=>g=>{n&&clearTimeout(n),f(g),s=!0},u=new Promise((f,g)=>{r=c(f),o=c(g),n&&(n=setTimeout(()=>o(new Error(`[deferred timeout] ${t}`)),n))});return{created:Date.now(),setTag:f=>t=f,resolve:r,reject:o,promise:u,get settled(){return s}}}const ye=new Map;window.__injectedUIEffects=ye;var bt=V(227),$e=V.n(bt);function Z(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const Xe="application/x-postmate-v1+json";let rr=0;const Lr={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},Bn=(n,t)=>(typeof t!="string"||n.origin===t)&&!!n.data&&(typeof n.data!="object"||"postmate"in n.data)&&n.data.type===Xe&&!!Lr[n.data.postmate];class Nr{constructor(t){Z(this,"parent",void 0),Z(this,"frame",void 0),Z(this,"child",void 0),Z(this,"events",{}),Z(this,"childOrigin",void 0),Z(this,"listener",void 0),this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=r=>{if(!Bn(r,this.childOrigin))return!1;const{data:o,name:s}=((r||{}).data||{}).value||{};r.data.postmate==="emit"&&s in this.events&&this.events[s].forEach(c=>{c.call(this,o)})},this.parent.addEventListener("message",this.listener,!1)}get(t,...r){return new Promise(o=>{const s=++rr,c=u=>{u.data.uid===s&&u.data.postmate==="reply"&&(this.parent.removeEventListener("message",c,!1),o(u.data.value))};this.parent.addEventListener("message",c,!1),this.child.postMessage({postmate:"request",type:Xe,property:t,args:r,uid:s},this.childOrigin)})}call(t,r){this.child.postMessage({postmate:"call",type:Xe,property:t,data:r},this.childOrigin)}on(t,r){this.events[t]||(this.events[t]=[]),this.events[t].push(r)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class Pr{constructor(t){Z(this,"model",void 0),Z(this,"parent",void 0),Z(this,"parentOrigin",void 0),Z(this,"child",void 0),this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",r=>{if(!Bn(r,this.parentOrigin))return;const{property:o,uid:s,data:c,args:u}=r.data;r.data.postmate!=="call"?((f,g,A)=>{const T=typeof f[g]=="function"?f[g].apply(null,A):f[g];return Promise.resolve(T)})(this.model,o,u).then(f=>{r.source.postMessage({property:o,postmate:"reply",type:Xe,uid:s,value:f},r.origin)}):o in this.model&&typeof this.model[o]=="function"&&this.model[o](c)})}emit(t,r){this.parent.postMessage({postmate:"emit",type:Xe,value:{name:t,data:r}},this.parentOrigin)}}class Gn{constructor(t){Z(this,"container",void 0),Z(this,"parent",void 0),Z(this,"frame",void 0),Z(this,"child",void 0),Z(this,"childOrigin",void 0),Z(this,"url",void 0),Z(this,"model",void 0),this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const r=(c=>{const u=document.createElement("a");u.href=c;const f=u.protocol.length>4?u.protocol:window.location.protocol,g=u.host.length?u.port==="80"||u.port==="443"?u.hostname:u.host:window.location.host;return u.origin||`${f}//${g}`})(t=t||this.url);let o,s=0;return new Promise((c,u)=>{const f=A=>!!Bn(A,r)&&(A.data.postmate==="handshake-reply"?(clearInterval(o),this.parent.removeEventListener("message",f,!1),this.childOrigin=A.origin,c(new Nr(this))):u("Failed handshake"));this.parent.addEventListener("message",f,!1);const g=()=>{s++,this.child.postMessage({postmate:"handshake",type:Xe,model:this.model},r),s===5&&clearInterval(o)};this.frame.addEventListener("load",()=>{g(),o=setInterval(g,500)}),this.frame.src=t})}destroy(){this.frame.parentNode.removeChild(this.frame)}}Z(Gn,"debug",!1),Z(Gn,"Model",void 0);class Rr{constructor(t){Z(this,"child",void 0),Z(this,"model",void 0),Z(this,"parent",void 0),Z(this,"parentOrigin",void 0),this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise((t,r)=>{const o=s=>{if(s.data.postmate){if(s.data.postmate==="handshake"){this.child.removeEventListener("message",o,!1),s.source.postMessage({postmate:"handshake-reply",type:Xe},s.origin),this.parentOrigin=s.origin;const c=s.data.model;return c&&Object.keys(c).forEach(u=>{this.model[u]=c[u]}),t(new Pr(this))}return r("Handshake Reply Failed")}};this.child.addEventListener("message",o,!1)})}}function on(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const{importHTML:Dr,createSandboxContainer:$r}=window.QSandbox||{};function Ur(n,t){return n.startsWith("http")?fetch(n,t):(n=n.replace("file://",""),new Promise(async(r,o)=>{try{const s=await window.apis.doAction(["readFile",n]);r({text:()=>s})}catch(s){console.error(s),o(s)}}))}class zr extends yt(){constructor(t){super(),on(this,"_pluginLocal",void 0),on(this,"_frame",void 0),on(this,"_root",void 0),on(this,"_loaded",!1),on(this,"_unmountFns",[]),this._pluginLocal=t,t._dispose(()=>{this._unmount()})}async load(){const{name:t,entry:r}=this._pluginLocal.options;if(this.loaded||!r)return;const{template:o,execScripts:s}=await Dr(r,{fetch:Ur});this._mount(o,document.body);const c=$r(t,{elementGetter:()=>{var f;return(f=this._root)===null||f===void 0?void 0:f.firstChild}}).instance.proxy;c.__shadow_mode__=!0,c.LSPluginLocal=this._pluginLocal,c.LSPluginShadow=this,c.LSPluginUser=c.logseq=new nr(this._pluginLocal.toJSON(),this._pluginLocal.caller);const u=await s(c,!0);this._unmountFns.push(u.unmount),this._loaded=!0}_mount(t,r){const o=this._frame=document.createElement("div");o.classList.add("lsp-shadow-sandbox"),o.id=this._pluginLocal.id,this._root=o.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,r.appendChild(o),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){var t,r;(t=this.frame)===null||t===void 0||(r=t.parentNode)===null||r===void 0||r.removeChild(this.frame)}get loaded(){return this._loaded}get document(){var t;return(t=this._root)===null||t===void 0?void 0:t.firstChild}get frame(){return this._frame}}function Ke(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const lt=$e()("LSPlugin:caller"),sn="#await#response#",qr="#lspmsg#",or="#lspmsg#error#",kn=n=>`#lspmsg#${n}`;class Hr extends yt(){constructor(t){super(),Ke(this,"_pluginLocal",void 0),Ke(this,"_connected",!1),Ke(this,"_parent",void 0),Ke(this,"_child",void 0),Ke(this,"_shadow",void 0),Ke(this,"_status",void 0),Ke(this,"_userModel",{}),Ke(this,"_call",void 0),Ke(this,"_callUserModel",void 0),Ke(this,"_debugTag",""),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const r=this,o=this._pluginLocal!=null;let s=0;const c=new Map,u=ve(6e4),f=this._extendUserModel({"#lspmsg#ready#":async T=>{f[kn(T?.pid)]=({type:I,payload:U})=>{lt(`[host (_call) -> *user] ${this._debugTag}`,I,U),r.emit(I,U)},await u.resolve()},"#lspmsg#beforeunload#":async T=>{const I=ve(1e4);r.emit("beforeunload",Object.assign({actor:I},T)),await I.promise},"#lspmsg#settings#":async({type:T,payload:I})=>{r.emit("settings:changed",I)},[qr]:async({ns:T,type:I,payload:U})=>{lt(`[host (async) -> *user] ${this._debugTag} ns=${T} type=${I}`,U),T&&T.startsWith("hook")?r.emit(`${T}:${I}`,U):r.emit(I,U)},"#lspmsg#reply#":({_sync:T,result:I})=>{if(lt(`[sync host -> *user] #${T}`,I),c.has(T)){const U=c.get(T);U&&(I!=null&&I.hasOwnProperty(or)?U.reject(I[or]):U.resolve(I),c.delete(T))}},...t});var g;if(o)return await u.promise,JSON.parse(JSON.stringify((g=this._pluginLocal)===null||g===void 0?void 0:g.toJSON()));const A=new Rr(f).sendHandshakeReply();return this._status="pending",await A.then(T=>{this._child=T,this._connected=!0,this._call=async(I,U={},J)=>{if(J){const H=++s;c.set(H,J),U._sync=H,J.setTag(`async call #${H}`),lt(`async call #${H}`)}return T.emit(kn(f.baseInfo.id),{type:I,payload:U}),J?.promise},this._callUserModel=async(I,U)=>{try{f[I](U)}catch{lt(`[model method] #${I} not existed`)}},setInterval(()=>{if(c.size>100)for(const[I,U]of c)U.settled&&c.delete(I)},18e5)}).finally(()=>{this._status=void 0}),await u.promise,f.baseInfo}async call(t,r={}){var o;return(o=this._call)===null||o===void 0?void 0:o.call(this,t,r)}async callAsync(t,r={}){var o;const s=ve(1e4);return(o=this._call)===null||o===void 0?void 0:o.call(this,t,r,s)}async callUserModel(t,...r){var o;return(o=this._callUserModel)===null||o===void 0?void 0:o.apply(this,[t,...r])}async callUserModelAsync(t,...r){var o;return t=`${sn}${t}`,(o=this._callUserModel)===null||o===void 0?void 0:o.apply(this,[t,...r])}async _setupIframeSandbox(){const t=this._pluginLocal,r=t.id,o=`${r}_lsp_main`,s=new URL(t.options.entry);s.searchParams.set("__v__",t.options.version);const c=document.querySelector(`#${o}`);c&&c.parentElement.removeChild(c);const u=document.createElement("div");u.classList.add("lsp-iframe-sandbox-container"),u.id=o,u.dataset.pid=r;try{var f;const I=(f=await this._pluginLocal._loadLayoutsData())===null||f===void 0?void 0:f.$$0;if(I){u.dataset.inited_layout="true";let{width:U,height:J,left:H,top:ne,vw:pe,vh:Ee}=I;H=Math.max(H,0),H=typeof pe=="number"?`${Math.min(100*H/pe,99)}%`:`${H}px`,ne=Math.max(ne,45),ne=typeof Ee=="number"?`${Math.min(100*ne/Ee,99)}%`:`${ne}px`,Object.assign(u.style,{width:U+"px",height:J+"px",left:H,top:ne})}}catch(I){console.error("[Restore Layout Error]",I)}document.body.appendChild(u);const g=new Gn({id:r+"_iframe",container:u,url:s.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}});let A,T=g.sendHandshake();return this._status="pending",new Promise((I,U)=>{A=setTimeout(()=>{U(new Error("handshake Timeout")),g.destroy()},4e3),T.then(J=>{this._parent=J,this._connected=!0,this.emit("connected"),J.on(kn(t.id),({type:H,payload:ne})=>{var pe,Ee;lt("[user -> *host] ",H,ne),(pe=this._pluginLocal)===null||pe===void 0||pe.emit(H,ne||{}),(Ee=this._pluginLocal)===null||Ee===void 0||Ee.caller.emit(H,ne||{})}),this._call=async(...H)=>{await J.call(kn(t.id),{type:H[0],payload:Object.assign(H[1]||{},{$$pid:t.id})})},this._callUserModel=async(H,...ne)=>{if(H.startsWith(sn))return await J.get(H.replace(sn,""),...ne);J.call(H,ne?.[0])},I(null)}).catch(J=>{U(J)}).finally(()=>{clearTimeout(A)})}).catch(I=>{throw lt("[iframe sandbox] error",I),I}).finally(()=>{this._status=void 0})}async _setupShadowSandbox(){const t=this._pluginLocal,r=this._shadow=new zr(t);try{this._status="pending",await r.load(),this._connected=!0,this.emit("connected"),this._call=async(o,s={},c)=>{var u;return c&&(s.actor=c),(u=this._pluginLocal)===null||u===void 0||u.emit(o,Object.assign(s,{$$pid:t.id})),c?.promise},this._callUserModel=async(...o)=>{var s;let c=o[0];(s=c)!==null&&s!==void 0&&s.startsWith(sn)&&(c=c.replace(sn,""));const u=o[1]||{},f=this._userModel[c];typeof f=="function"&&await f.call(null,u)}}catch(o){throw lt("[shadow sandbox] error",o),o}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxShadowContainer(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame.parentNode}_getSandboxIframeRoot(){var t;return(t=this._parent)===null||t===void 0?void 0:t.frame}_getSandboxShadowRoot(){var t;return(t=this._shadow)===null||t===void 0?void 0:t.frame}set debugTag(t){this._debugTag=t}async destroy(){var t;let r=null;this._parent&&(r=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(r=this._getSandboxShadowContainer(),this._shadow.destroy()),(t=r)===null||t===void 0||t.parentNode.removeChild(r)}}function ir(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}class sr{constructor(t,r){ir(this,"ctx",void 0),ir(this,"opts",void 0),this.ctx=t,this.opts=r}get ctxId(){return this.ctx.baseInfo.id}setItem(t,r){var o;return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,r,(o=this.opts)===null||o===void 0?void 0:o.assets]})}getItem(t){var r;return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}removeItem(t){var r;return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}allKeys(){var t;return this.ctx.caller.callAsync("api:call",{method:"list-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}clear(){var t;return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId,(t=this.opts)===null||t===void 0?void 0:t.assets]})}hasItem(t){var r;return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t,(r=this.opts)===null||r===void 0?void 0:r.assets]})}}class Br{constructor(t){var r,o,s;s=void 0,(o="ctx")in(r=this)?Object.defineProperty(r,o,{value:s,enumerable:!0,configurable:!0,writable:!0}):r[o]=s,this.ctx=t}get React(){return this.ensureHostScope().React}get ReactDOM(){return this.ensureHostScope().ReactDOM}get pluginLocal(){return this.ensureHostScope().LSPluginCore.ensurePlugin(this.ctx.baseInfo.id)}invokeExperMethod(t,...r){var o,s;const c=this.ensureHostScope();return t=(o=C(t))===null||o===void 0?void 0:o.toLowerCase(),(s=c.logseq.api["exper_"+t])===null||s===void 0?void 0:s.apply(c,r)}async loadScripts(...t){(t=t.map(r=>r!=null&&r.startsWith("http")?r:this.ctx.resolveResourceFullUrl(r))).unshift(this.ctx.baseInfo.id),await this.invokeExperMethod("loadScripts",...t)}registerFencedCodeRenderer(t,r){return this.ensureHostScope().logseq.api.exper_register_fenced_code_renderer(this.ctx.baseInfo.id,t,r)}registerExtensionsEnhancer(t,r){const o=this.ensureHostScope();return t==="katex"&&o.katex&&r(o.katex).catch(console.error),o.logseq.api.exper_register_extensions_enhancer(this.ctx.baseInfo.id,t,r)}ensureHostScope(){if(window===top)throw new Error("Can not access host scope!");return top}}function It(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const ar=n=>`task_callback_${n}`;class Gr{constructor(t,r,o={}){It(this,"_client",void 0),It(this,"_requestId",void 0),It(this,"_requestOptions",void 0),It(this,"_promise",void 0),It(this,"_aborted",!1),this._client=t,this._requestId=r,this._requestOptions=o,this._promise=new Promise((f,g)=>{if(!this._requestId)return g(null);this._client.once(ar(this._requestId),A=>{A&&A instanceof Error?g(A):f(A)})});const{success:s,fail:c,final:u}=this._requestOptions;this._promise.then(f=>{s?.(f)}).catch(f=>{c?.(f)}).finally(()=>{u?.()})}abort(){this._requestOptions.abortable&&!this._aborted&&(this._client.ctx._execCallableAPI("http_request_abort",this._requestId),this._aborted=!0)}get promise(){return this._promise}get client(){return this._client}get requestId(){return this._requestId}}class Wn extends nn.EventEmitter{constructor(t){super(),It(this,"_ctx",void 0),this._ctx=t,this.ctx.caller.on("#lsp#request#callback",r=>{const o=r?.requestId;o&&this.emit(ar(o),r?.payload)})}static createRequestTask(t,r,o){return new Gr(t,r,o)}async _request(t){const r=this.ctx.baseInfo.id,{success:o,fail:s,final:c,...u}=t,f=this.ctx.Experiments.invokeExperMethod("request",r,u),g=Wn.createRequestTask(this.ctx.Request,f,t);return u.abortable?g:g.promise}get ctx(){return this._ctx}}const Wr=dn(Object.keys,Object);var Jr=Object.prototype.hasOwnProperty;const Kr=function(n){if(!Rt(n))return Wr(n);var t=[];for(var r in Object(n))Jr.call(n,r)&&r!="constructor"&&t.push(r);return t},Jn=function(n){return ht(n)?jt(n):Kr(n)},Zr=function(n,t){return n&&cn(n,t,Jn)},Vr=function(n){return this.__data__.set(n,"__lodash_hash_undefined__"),this},Yr=function(n){return this.__data__.has(n)};function jn(n){var t=-1,r=n==null?0:n.length;for(this.__data__=new Le;++t<r;)this.add(n[t])}jn.prototype.add=jn.prototype.push=Vr,jn.prototype.has=Yr;const Qr=jn,Xr=function(n,t){for(var r=-1,o=n==null?0:n.length;++r<o;)if(t(n[r],r,n))return!0;return!1},eo=function(n,t){return n.has(t)},cr=function(n,t,r,o,s,c){var u=1&r,f=n.length,g=t.length;if(f!=g&&!(u&&g>f))return!1;var A=c.get(n),T=c.get(t);if(A&&T)return A==t&&T==n;var I=-1,U=!0,J=2&r?new Qr:void 0;for(c.set(n,t),c.set(t,n);++I<f;){var H=n[I],ne=t[I];if(o)var pe=u?o(ne,H,I,t,n,c):o(H,ne,I,n,t,c);if(pe!==void 0){if(pe)continue;U=!1;break}if(J){if(!Xr(t,function(Ee,et){if(!eo(J,et)&&(H===Ee||s(H,Ee,r,o,c)))return J.push(et)})){U=!1;break}}else if(H!==ne&&!s(H,ne,r,o,c)){U=!1;break}}return c.delete(n),c.delete(t),U},to=function(n){var t=-1,r=Array(n.size);return n.forEach(function(o,s){r[++t]=[s,o]}),r},no=function(n){var t=-1,r=Array(n.size);return n.forEach(function(o){r[++t]=o}),r};var lr=l?l.prototype:void 0,Kn=lr?lr.valueOf:void 0;const ro=function(n,t,r,o,s,c,u){switch(r){case"[object DataView]":if(n.byteLength!=t.byteLength||n.byteOffset!=t.byteOffset)return!1;n=n.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(n.byteLength!=t.byteLength||!c(new rt(n),new rt(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return k(+n,+t);case"[object Error]":return n.name==t.name&&n.message==t.message;case"[object RegExp]":case"[object String]":return n==t+"";case"[object Map]":var f=to;case"[object Set]":var g=1&o;if(f||(f=no),n.size!=t.size&&!g)return!1;var A=u.get(n);if(A)return A==t;o|=2,u.set(n,t);var T=cr(f(n),f(t),o,s,c,u);return u.delete(n),T;case"[object Symbol]":if(Kn)return Kn.call(n)==Kn.call(t)}return!1},oo=function(n,t){for(var r=-1,o=t.length,s=n.length;++r<o;)n[s+r]=t[r];return n},io=function(n,t,r){var o=t(n);return Ie(n)?o:oo(o,r(n))},so=function(n,t){for(var r=-1,o=n==null?0:n.length,s=0,c=[];++r<o;){var u=n[r];t(u,r,n)&&(c[s++]=u)}return c},ao=function(){return[]};var co=Object.prototype.propertyIsEnumerable,ur=Object.getOwnPropertySymbols;const lo=ur?function(n){return n==null?[]:(n=Object(n),so(ur(n),function(t){return co.call(n,t)}))}:ao,fr=function(n){return io(n,Jn,lo)};var uo=Object.prototype.hasOwnProperty;const fo=function(n,t,r,o,s,c){var u=1&r,f=fr(n),g=f.length;if(g!=fr(t).length&&!u)return!1;for(var A=g;A--;){var T=f[A];if(!(u?T in t:uo.call(t,T)))return!1}var I=c.get(n),U=c.get(t);if(I&&U)return I==t&&U==n;var J=!0;c.set(n,t),c.set(t,n);for(var H=u;++A<g;){var ne=n[T=f[A]],pe=t[T];if(o)var Ee=u?o(pe,ne,T,t,n,c):o(ne,pe,T,n,t,c);if(!(Ee===void 0?ne===pe||s(ne,pe,r,o,c):Ee)){J=!1;break}H||(H=T=="constructor")}if(J&&!H){var et=n.constructor,wt=t.constructor;et==wt||!("constructor"in n)||!("constructor"in t)||typeof et=="function"&&et instanceof et&&typeof wt=="function"&&wt instanceof wt||(J=!1)}return c.delete(n),c.delete(t),J},Zn=ke(a,"DataView"),Vn=ke(a,"Promise"),Yn=ke(a,"Set"),Qn=ke(a,"WeakMap");var pr="[object Map]",dr="[object Promise]",hr="[object Set]",gr="[object WeakMap]",mr="[object DataView]",po=W(Zn),ho=W(Te),go=W(Vn),mo=W(Yn),vo=W(Qn),_t=ue;(Zn&&_t(new Zn(new ArrayBuffer(1)))!=mr||Te&&_t(new Te)!=pr||Vn&&_t(Vn.resolve())!=dr||Yn&&_t(new Yn)!=hr||Qn&&_t(new Qn)!=gr)&&(_t=function(n){var t=ue(n),r=t=="[object Object]"?n.constructor:void 0,o=r?W(r):"";if(o)switch(o){case po:return mr;case ho:return pr;case go:return dr;case mo:return hr;case vo:return gr}return t});const vr=_t;var yr="[object Arguments]",br="[object Array]",An="[object Object]",_r=Object.prototype.hasOwnProperty;const yo=function(n,t,r,o,s,c){var u=Ie(n),f=Ie(t),g=u?br:vr(n),A=f?br:vr(t),T=(g=g==yr?An:g)==An,I=(A=A==yr?An:A)==An,U=g==A;if(U&&se(n)){if(!se(t))return!1;u=!0,T=!1}if(U&&!T)return c||(c=new Ve),u||Qe(n)?cr(n,t,r,o,s,c):ro(n,t,g,r,o,s,c);if(!(1&r)){var J=T&&_r.call(n,"__wrapped__"),H=I&&_r.call(t,"__wrapped__");if(J||H){var ne=J?n.value():n,pe=H?t.value():t;return c||(c=new Ve),s(ne,pe,r,o,c)}}return!!U&&(c||(c=new Ve),fo(n,t,r,o,s,c))},wr=function n(t,r,o,s,c){return t===r||(t==null||r==null||!me(t)&&!me(r)?t!=t&&r!=r:yo(t,r,o,s,n,c))},bo=function(n,t,r,o){var s=r.length,c=s,u=!o;if(n==null)return!c;for(n=Object(n);s--;){var f=r[s];if(u&&f[2]?f[1]!==n[f[0]]:!(f[0]in n))return!1}for(;++s<c;){var g=(f=r[s])[0],A=n[g],T=f[1];if(u&&f[2]){if(A===void 0&&!(g in n))return!1}else{var I=new Ve;if(o)var U=o(A,T,g,n,t,I);if(!(U===void 0?wr(T,A,3,o,I):U))return!1}}return!0},xr=function(n){return n==n&&!Me(n)},_o=function(n){for(var t=Jn(n),r=t.length;r--;){var o=t[r],s=n[o];t[r]=[o,s,xr(s)]}return t},Cr=function(n,t){return function(r){return r!=null&&r[n]===t&&(t!==void 0||n in Object(r))}},wo=function(n){var t=_o(n);return t.length==1&&t[0][2]?Cr(t[0][0],t[0][1]):function(r){return r===n||bo(r,n,t)}},Xn=function(n){return typeof n=="symbol"||me(n)&&ue(n)=="[object Symbol]"};var xo=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Co=/^\w*$/;const er=function(n,t){if(Ie(n))return!1;var r=typeof n;return!(r!="number"&&r!="symbol"&&r!="boolean"&&n!=null&&!Xn(n))||Co.test(n)||!xo.test(n)||t!=null&&n in Object(t)};function tr(n,t){if(typeof n!="function"||t!=null&&typeof t!="function")throw new TypeError("Expected a function");var r=function(){var o=arguments,s=t?t.apply(this,o):o[0],c=r.cache;if(c.has(s))return c.get(s);var u=n.apply(this,o);return r.cache=c.set(s,u)||c,u};return r.cache=new(tr.Cache||Le),r}tr.Cache=Le;const Oo=tr;var So=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,ko=/\\(\\)?/g;const jo=function(n){var t=Oo(n,function(o){return r.size===500&&r.clear(),o}),r=t.cache;return t}(function(n){var t=[];return n.charCodeAt(0)===46&&t.push(""),n.replace(So,function(r,o,s,c){t.push(s?c.replace(ko,"$1"):o||r)}),t}),Ao=function(n,t){for(var r=-1,o=n==null?0:n.length,s=Array(o);++r<o;)s[r]=t(n[r],r,n);return s};var Or=l?l.prototype:void 0,Sr=Or?Or.toString:void 0;const Eo=function n(t){if(typeof t=="string")return t;if(Ie(t))return Ao(t,n)+"";if(Xn(t))return Sr?Sr.call(t):"";var r=t+"";return r=="0"&&1/t==-1/0?"-0":r},To=function(n){return n==null?"":Eo(n)},kr=function(n,t){return Ie(n)?n:er(n,t)?[n]:jo(To(n))},En=function(n){if(typeof n=="string"||Xn(n))return n;var t=n+"";return t=="0"&&1/n==-1/0?"-0":t},jr=function(n,t){for(var r=0,o=(t=kr(t,n)).length;n!=null&&r<o;)n=n[En(t[r++])];return r&&r==o?n:void 0},Io=function(n,t,r){var o=n==null?void 0:jr(n,t);return o===void 0?r:o},Mo=function(n,t){return n!=null&&t in Object(n)},Fo=function(n,t,r){for(var o=-1,s=(t=kr(t,n)).length,c=!1;++o<s;){var u=En(t[o]);if(!(c=n!=null&&r(n,u)))break;n=n[u]}return c||++o!=s?c:!!(s=n==null?0:n.length)&&Ut(s)&&kt(u,s)&&(Ie(n)||Ot(n))},Lo=function(n,t){return n!=null&&Fo(n,t,Mo)},No=function(n,t){return er(n)&&xr(t)?Cr(En(n),t):function(r){var o=Io(r,n);return o===void 0&&o===t?Lo(r,n):wr(t,o,3)}},Po=function(n){return function(t){return t?.[n]}},Ro=function(n){return function(t){return jr(t,n)}},Do=function(n){return er(n)?Po(En(n)):Ro(n)},$o=function(n){return typeof n=="function"?n:n==null?Et:typeof n=="object"?Ie(n)?No(n[0],n[1]):wo(n):Do(n)},Uo=function(n,t){var r={};return t=$o(t),Zr(n,function(o,s,c){Ct(r,t(o,s,c),o)}),r};function Ar(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}class zo{constructor(t,r){Ar(this,"ctx",void 0),Ar(this,"serviceHooks",void 0),this.ctx=t,this.serviceHooks=r,t._execCallableAPI("register-search-service",t.baseInfo.id,r.name,r.options),Object.entries({query:{f:"onQuery",args:["graph","q",!0],reply:!0,transformOutput:o=>(Ie(o?.blocks)&&(o.blocks=o.blocks.map(s=>s&&Uo(s,(c,u)=>`block/${u}`))),o)},rebuildBlocksIndice:{f:"onIndiceInit",args:["graph","blocks"]},transactBlocks:{f:"onBlocksChanged",args:["graph","data"]},truncateBlocks:{f:"onIndiceReset",args:["graph"]},removeDb:{f:"onGraph",args:["graph"]}}).forEach(([o,s])=>{const c=(u=>`service:search:${u}:${r.name}`)(o);t.caller.on(c,async u=>{if(p(r?.[s.f])){let f=null;try{f=await r[s.f].apply(r,(s.args||[]).map(g=>{if(u){if(g===!0)return u;if(u.hasOwnProperty(g)){const A=u[g];return delete u[g],A}}})),s.transformOutput&&(f=s.transformOutput(f))}catch(g){console.error("[SearchService] ",g),f=g}finally{s.reply&&t.caller.call(`${c}:reply`,f)}}})})}}function Ue(n,t,r){return t in n?Object.defineProperty(n,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):n[t]=r,n}const qo=Symbol.for("proxy-continue"),Ho=$e()("LSPlugin:user"),Er=new te("",{console:!0});function Mt(n,t,r){var o;if(typeof r!="function")return!1;const{key:s,label:c,desc:u,palette:f,keybinding:g,extras:A}=t,T=`SimpleCommandHook${s}${++Mr}`;this.Editor["on"+T](r),(o=this.caller)===null||o===void 0||o.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:s,label:c,type:n,desc:u,keybinding:g,extras:A},["editor/hook",T]],f]})}function Tr(n){return!(typeof(t=n)!="string"||t.length!==36||!/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/gi.test(t))||(Er.error(`#${n} is not a valid UUID string.`),!1);var t}let Tn=null,Ir=new Map;const Bo={async getInfo(n){return Tn||(Tn=await this._execCallableAPIAsync("get-app-info")),typeof n=="string"?Tn[n]:Tn},registerCommand:Mt,registerSearchService(n){if(Ir.has(n.name))throw new Error(`SearchService: #${n.name} has registered!`);Ir.set(n.name,new zo(this,n))},registerCommandPalette(n,t){const{key:r,label:o,keybinding:s}=n;return Mt.call(this,"$palette$",{key:r,label:o,palette:!0,keybinding:s},t)},registerCommandShortcut(n,t){const{binding:r}=n,o="$shortcut$",s=o+C(r);return Mt.call(this,o,{key:s,palette:!1,keybinding:n},t)},registerUIItem(n,t){var r;const o=this.baseInfo.id;(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-ui-item",args:[o,n,t]})},registerPageMenuItem(n,t){if(typeof t!="function")return!1;const r=n+"_"+this.baseInfo.id,o=n;Mt.call(this,"page-menu-item",{key:r,label:o},t)},onBlockRendererSlotted(n,t){if(!Tr(n))return;const r=this.baseInfo.id,o=`hook:editor:${C(`slot:${n}`)}`;return this.caller.on(o,t),this.App._installPluginHook(r,o),()=>{this.caller.off(o,t),this.App._uninstallPluginHook(r,o)}},invokeExternalPlugin(n,...t){var r;if(!(n=(r=n)===null||r===void 0?void 0:r.trim()))return;let[o,s]=n.split(".");if(!["models","commands"].includes(s?.toLowerCase()))throw new Error("Type only support '.models' or '.commands' currently.");const c=n.replace(`${o}.${s}.`,"");if(!o||!s||!c)throw new Error(`Illegal type of #${n} to invoke external plugin.`);return this._execCallableAPIAsync("invoke_external_plugin_cmd",o,s.toLowerCase(),c,t)},setFullScreen(n){const t=(...r)=>this._callWin("setFullScreen",...r);n==="toggle"?this._callWin("isFullScreen").then(r=>{r?t():t(!0)}):n?t(!0):t()}};let Mr=0;const Go={newBlockUUID(){return this._execCallableAPIAsync("new_block_uuid")},registerSlashCommand(n,t){var r;Ho("Register slash command #",this.baseInfo.id,n,t),typeof t=="function"&&(t=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",t]]),t=t.map(o=>{const[s,...c]=o;if(s==="editor/hook"){let u=c[0],f=()=>{var A;(A=this.caller)===null||A===void 0||A.callUserModel(u)};typeof u=="function"&&(f=u);const g=`SlashCommandHook${s}${++Mr}`;o[1]=g,this.Editor["on"+g](f)}return o}),(r=this.caller)===null||r===void 0||r.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[n,t]]})},registerBlockContextMenuItem(n,t){if(typeof t!="function")return!1;const r=n+"_"+this.baseInfo.id;Mt.call(this,"block-context-menu-item",{key:r,label:n},t)},registerHighlightContextMenuItem(n,t,r){if(typeof t!="function")return!1;const o=n+"_"+this.baseInfo.id;Mt.call(this,"highlight-context-menu-item",{key:o,label:n,extras:r},t)},scrollToBlockInPage(n,t,r){const o="block-content-"+t;r!=null&&r.replaceState?this.App.replaceState("page",{name:n},{anchor:o}):this.App.pushState("page",{name:n},{anchor:o})}},Wo={onBlockChanged(n,t){if(!Tr(n))return;const r=this.baseInfo.id,o=`hook:db:${C(`block:${n}`)}`,s=({block:c,txData:u,txMeta:f})=>{c.uuid===n&&t(c,u,f)};return this.caller.on(o,s),this.App._installPluginHook(r,o),()=>{this.caller.off(o,s),this.App._uninstallPluginHook(r,o)}},datascriptQuery(n,...t){return t.pop(),t!=null&&t.some(r=>typeof r=="function")?this.Experiments.ensureHostScope().logseq.api.datascript_query(n,...t):this._execCallableAPIAsync("datascript_query",n,...t)}},Jo={},Ko={},Zo={makeSandboxStorage(){return new sr(this,{assets:!0})}};class nr extends yt(){constructor(t,r){super(),Ue(this,"_baseInfo",void 0),Ue(this,"_caller",void 0),Ue(this,"_version","0.0.15"),Ue(this,"_debugTag",""),Ue(this,"_settingsSchema",void 0),Ue(this,"_connected",!1),Ue(this,"_ui",new Map),Ue(this,"_mFileStorage",void 0),Ue(this,"_mRequest",void 0),Ue(this,"_mExperiments",void 0),Ue(this,"_beforeunloadCallback",void 0),this._baseInfo=t,this._caller=r,r.on("sys:ui:visible",o=>{o!=null&&o.toggle&&this.toggleMainUI()}),r.on("settings:changed",o=>{const s=Object.assign({},this.settings),c=Object.assign(this._baseInfo.settings,o);this.emit("settings:changed",{...c},s)}),r.on("beforeunload",async o=>{const{actor:s,...c}=o,u=this._beforeunloadCallback;try{u&&await u(c),s?.resolve(null)}catch(f){console.debug(`${r.debugTag} [beforeunload] `,f),s?.reject(f)}})}async ready(t,r){if(!this._connected)try{var o;typeof t=="function"&&(r=t,t={});let s=await this._caller.connectToParent(t);this._connected=!0,s=w(this._baseInfo,s),(o=s)!==null&&o!==void 0&&o.id&&(this._debugTag=this._caller.debugTag=`#${s.id} [${s.name}]`,this.logger.setTag(this._debugTag)),this._settingsSchema&&(s.settings=function(c,u){const f=(u||[]).reduce((g,A)=>("default"in A&&(g[A.key]=A.default),g),{});return Object.assign(f,c)}(s.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema));try{await this._execCallableAPIAsync("setSDKMetadata",{version:this._version})}catch(c){console.warn(c)}r&&r.call(this,s)}catch(s){console.error(`${this._debugTag} [Ready Error]`,s)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){typeof t=="function"&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const r="settings:changed";return this.on(r,t),()=>this.off(r,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const r={key:0,visible:!1,cursor:t?.restoreEditingCursor};this.caller.call("main-ui:visible",r),this.emit("ui:visible:changed",r),this._ui.set(r.key,r)}showMainUI(t){const r={key:0,visible:!0,autoFocus:t?.autoFocus};this.caller.call("main-ui:visible",r),this.emit("ui:visible:changed",r),this._ui.set(r.key,r)}toggleMainUI(){const r=this._ui.get(0);r&&r.visible?this.hideMainUI():this.showMainUI()}get version(){return this._version}get isMainUIVisible(){const t=this._ui.get(0);return!!(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get effect(){return(t=this)&&(((r=t.baseInfo)===null||r===void 0?void 0:r.effect)||!((o=t.baseInfo)!==null&&o!==void 0&&o.iir));var t,r,o}get logger(){return Er}get settings(){var t;return(t=this.baseInfo)===null||t===void 0?void 0:t.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),le(this._baseInfo.lsr,t)}_makeUserProxy(t,r){const o=this,s=this.caller;return new Proxy(t,{get(c,u,f){const g=c[u];return function(...A){if(g){const I=g.apply(o,A.concat(r));if(I!==qo)return I}if(r){const I=u.toString().match(/^(once|off|on)/i);if(I!=null){const U=I[0].toLowerCase(),J=I.input.slice(U.length),H=U==="off",ne=o.baseInfo.id,pe=`hook:${r}:${C(J)}`,Ee=A[0],et=A[1];s[U](pe,Ee);const wt=()=>{s.off(pe,Ee),s.listenerCount(pe)||o.App._uninstallPluginHook(ne,pe)};return H?void wt():(o.App._installPluginHook(ne,pe,et),wt)}}let T=u;return["git","ui","assets"].includes(r)&&(T=r+"_"+T),s.callAsync("api:call",{tag:r,method:T,args:A})}}})}_execCallableAPIAsync(t,...r){return this._caller.callAsync("api:call",{method:t,args:r})}_execCallableAPI(t,...r){this._caller.call("api:call",{method:t,args:r})}_callWin(...t){return this._execCallableAPIAsync("_callMainWin",...t)}get App(){return this._makeUserProxy(Bo,"app")}get Editor(){return this._makeUserProxy(Go,"editor")}get DB(){return this._makeUserProxy(Wo,"db")}get Git(){return this._makeUserProxy(Jo,"git")}get UI(){return this._makeUserProxy(Ko,"ui")}get Assets(){return this._makeUserProxy(Zo,"assets")}get FileStorage(){let t=this._mFileStorage;return t||(t=this._mFileStorage=new sr(this)),t}get Request(){let t=this._mRequest;return t||(t=this._mRequest=new Wn(this)),t}get Experiments(){let t=this._mExperiments;return t||(t=this._mExperiments=new Br(this)),t}}function Fr(n,t){return new nr(n,t)}if(window.__LSP__HOST__==null){const n=new Hr(null);window.logseq=Fr({},n)}})(),je})())})(lsplugin_user,lsplugin_user.exports);lsplugin_user.exports;const extractCodeBlockFromMarkdown=oe=>{const ze=/```(?:\w+\s)?([\s\S]*?)```/.exec(oe);return ze?ze[1]:""},logseq$1={id:"byp-logseq-ai-auto-tags",icon:"./logo.svg"},pluginId=logseq$1.id,loadingKey="loading",getBlockTags=oe=>new Promise((be,ze)=>{logseq.UI.showMsg("加载中...","warning",{key:loadingKey,timeout:1e8}),fetch("https://aip.baidubce.com/rpc/2.0/ai_custom/v1/wenxinworkshop/chat/completions_pro?access_token=24.9ea5bdaf838deb0a9a9543d1e4bbc1b3.2592000.1701168025.282335-41940014",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"user",content:"你好，你现在要做一个从文字中提炼标签的助手，有以下要求：1. 要求提炼的标签必须准确，尽可能从原文取词, 2. 提炼的标签尽可能少，只有最符合主题的才需要被提炼, 3. 标签中间不能有空格。接下来我会发一段文字，文字内容会用六角括号包裹，你需要提炼出来标签并且用 JavaScript 中数组的形式返回，例如我会发〔鲁迅是中国最伟大的作家之一〕，你要回答 ```['鲁迅', '作家']``` ，注意，回答内容必须要用 ``` 包起来，明白了吗？"},{role:"assistant",content:"明白了，请输入您需要提炼标签的文字。"},{role:"user",content:`〔${oe}〕`}],temperature:.1})}).then(_e=>_e.json()).then(_e=>{logseq.UI.closeMsg(loadingKey),_e.error_code&&_e.error_msg?(ze(_e.error_msg),logseq.UI.showMsg(_e.error_msg,"error")):be(_e)}).catch(_e=>{ze(_e),logseq.UI.closeMsg(loadingKey),logseq.UI.showMsg(JSON.stringify(_e),"error")})}),setBlockTags=async e=>{const block=await logseq.Editor.getBlock(e.uuid);if(block?.content){const res=await getBlockTags(block?.content),tags=eval(extractCodeBlockFromMarkdown(res.result));await logseq.Editor.updateBlock(block?.uuid,`${block.content} '#☘️🕰/key ' ${tags.map(oe=>""+oe).join(" ")}`),logseq.Editor.exitEditingMode()}},setPageTags=async e=>{const page=await logseq.Editor.getPage(e.page),tree=await logseq.Editor.getPageBlocksTree(e.page);if(!tree.length)return;const{currentGraph}=await logseq.App.getUserConfigs(),basePath=currentGraph.split("logseq_local_")[1],folder=page?.["journal?"]?"journals":"pages",pageName=page?.["journal?"]?page.journalDay?.toString().replace(/(\d{4})(\d{2})(\d{2})/,"$1_$2_$3"):page?.name,url=`file://${basePath}/${folder}/${pageName}.md`,content=await fetch(url).then(oe=>oe.text()),res=await getBlockTags(content),tags=eval(extractCodeBlockFromMarkdown(res.result)),regex=/(\w+)::\s*([^]+?)(?:\n|$)/g,matches=[];let match;for(;(match=regex.exec(tree[0].content))!==null;){const oe=match[1],be=match[2];matches.push({key:oe,value:be})}const properties=await logseq.Editor.getBlockProperties(tree[0].uuid);matches.length===0&&page?.uuid?await logseq.Editor.insertBlock(page.uuid,"",{before:!0,properties:{tags}}):matches.find(oe=>oe.key==="tags")?await logseq.Editor.updateBlock(tree[0].uuid,"",{properties:{...properties,tags:`${matches.find(oe=>oe.key==="tags")?.value}, ${tags.join(", ")}`}}):await logseq.Editor.updateBlock(tree[0].uuid,"",{properties:{...properties,tags:tags.join(", ")}}),logseq.Editor.exitEditingMode()};async function main(){console.info(`#${pluginId}: MAIN`),logseq.Editor.registerSlashCommand("🤖 AI auto tags",setBlockTags),logseq.Editor.registerBlockContextMenuItem("🤖 AI auto tags",setBlockTags),logseq.App.registerPageMenuItem("🤖 AI auto tags",setPageTags)}logseq.ready(main).catch(console.error);
